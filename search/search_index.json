{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Documentation Essensys Raspberry Pi","text":"<p>Bienvenue dans la documentation compl\u00e8te pour l'installation et la configuration d'Essensys sur Raspberry Pi 4.</p>"},{"location":"#demarrage-rapide","title":"\ud83d\ude80 D\u00e9marrage rapide","text":"<ol> <li>Pr\u00e9paration du mat\u00e9riel - SSD, adaptateur USB-SATA, Raspberry Pi 4</li> <li>Installation de l'OS - Installation de Raspberry Pi OS sur le SSD</li> <li>Installation Essensys - D\u00e9ploiement du backend et frontend</li> <li>Configuration r\u00e9seau - Configuration SSH et r\u00e9seau</li> <li>Acc\u00e8s aux services - URLs locales et WAN</li> </ol>"},{"location":"#sections-principales","title":"\ud83d\udcda Sections principales","text":""},{"location":"#installation","title":"Installation","text":"<ul> <li>Pr\u00e9paration du mat\u00e9riel</li> <li>Installation de l'OS</li> <li>Installation Essensys</li> </ul>"},{"location":"#connexion","title":"Connexion","text":"<ul> <li>Connexion SSH</li> <li>Configuration r\u00e9seau</li> </ul>"},{"location":"#logs","title":"Logs","text":"<ul> <li>Logs backend</li> <li>Logs Nginx</li> <li>Logs Traefik</li> </ul>"},{"location":"#acces","title":"Acc\u00e8s","text":"<ul> <li>Acc\u00e8s local</li> <li>Acc\u00e8s WAN</li> </ul>"},{"location":"#configuration-routeur","title":"Configuration Routeur","text":"<ul> <li>Ubiquiti Dream Machine Pro</li> <li>Freebox</li> <li>SFR</li> <li>Orange Livebox</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<ul> <li>Vue d'ensemble</li> <li>Backend</li> <li>Frontend</li> <li>Nginx</li> <li>Traefik</li> <li>Ports utilis\u00e9s</li> </ul>"},{"location":"#maintenance","title":"Maintenance","text":"<ul> <li>Mise \u00e0 jour</li> <li>D\u00e9sinstallation</li> <li>D\u00e9pannage</li> </ul>"},{"location":"#architecture_1","title":"\ud83c\udfd7\ufe0f Architecture","text":"<pre><code>graph TB\n    Client[Client Essensys&lt;br/&gt;192.168.1.151]\n    BrowserLocal[Navigateur Local&lt;br/&gt;mon.essensys.fr]\n    BrowserWAN[Navigateur WAN&lt;br/&gt;essensys.acme.com]\n\n    Nginx[Nginx&lt;br/&gt;Port 80: API locales&lt;br/&gt;Port 9090: Frontend interne]\n    Traefik[Traefik&lt;br/&gt;Port 443: Frontend WAN HTTPS]\n    Backend[Backend Go&lt;br/&gt;Port 7070]\n    Frontend[Frontend React&lt;br/&gt;Fichiers statiques]\n\n    Client --&gt;|mon.essensys.fr/api/*| Nginx\n    BrowserLocal --&gt;|mon.essensys.fr/| Nginx\n    BrowserWAN --&gt;|essensys.acme.com/| Traefik\n\n    Nginx --&gt;|/api/*| Backend\n    Nginx --&gt;|/| Frontend\n    Traefik --&gt;|Frontend| Nginx\n\n    style Client fill:#e1f5ff\n    style BrowserLocal fill:#fff4e1\n    style BrowserWAN fill:#fff4e1\n    style Nginx fill:#e8f5e9\n    style Traefik fill:#e3f2fd\n    style Backend fill:#f3e5f5\n    style Frontend fill:#fff4e1</code></pre>"},{"location":"#composants","title":"\ud83d\udce6 Composants","text":"<ul> <li>Backend Go : API REST et communication avec les clients Essensys legacy</li> <li>Frontend React : Interface web moderne</li> <li>Nginx : Reverse proxy pour les API locales et le frontend local</li> <li>Traefik : Reverse proxy avanc\u00e9 pour l'acc\u00e8s WAN avec HTTPS et authentification</li> </ul>"},{"location":"#securite","title":"\ud83d\udd12 S\u00e9curit\u00e9","text":"<ul> <li>Local : Acc\u00e8s HTTP sans authentification</li> <li>WAN : Acc\u00e8s HTTPS avec authentification basique</li> <li>API WAN : Seul <code>/api/admin/inject</code> est accessible en WAN (HTTPS + auth)</li> <li>Autres API WAN : Bloqu\u00e9es (403 Forbidden)</li> </ul>"},{"location":"#notes-importantes","title":"\ud83d\udcdd Notes importantes","text":"<ul> <li>Le client Essensys legacy (BP_MQX_ETH) n\u00e9cessite des r\u00e9ponses HTTP en un seul paquet TCP</li> <li>Nginx est configur\u00e9 sp\u00e9cifiquement pour cette compatibilit\u00e9</li> <li>Traefik g\u00e8re uniquement le frontend WAN, les API locales restent sur Nginx</li> </ul>"},{"location":"acces/","title":"Acc\u00e8s aux services","text":"<p>Cette section explique comment acc\u00e9der aux services Essensys en local et depuis Internet (WAN).</p>"},{"location":"acces/#sections","title":"Sections","text":"<ol> <li>Acc\u00e8s local - Acc\u00e9der aux services depuis le r\u00e9seau local</li> <li>Acc\u00e8s WAN - Acc\u00e9der aux services depuis Internet</li> </ol>"},{"location":"acces/#vue-densemble","title":"Vue d'ensemble","text":"<pre><code>graph TB\n    Local[Acc\u00e8s Local&lt;br/&gt;mon.essensys.fr]\n    WAN[Acc\u00e8s WAN&lt;br/&gt;essensys.acme.com]\n\n    Local --&gt;|HTTP| Nginx[Nginx Port 80]\n    WAN --&gt;|HTTPS + Auth| Traefik[Traefik Port 443]\n\n    Nginx --&gt; Backend[Backend Port 7070]\n    Nginx --&gt; Frontend[Frontend]\n    Traefik --&gt; Nginx\n\n    style Local fill:#e1f5ff\n    style WAN fill:#fff4e1\n    style Nginx fill:#e8f5e9\n    style Traefik fill:#e3f2fd\n    style Backend fill:#f3e5f5\n    style Frontend fill:#fff4e1</code></pre>"},{"location":"acces/local/","title":"Acc\u00e8s local","text":"<p>Acc\u00e8s aux services Essensys depuis le r\u00e9seau local (LAN).</p>"},{"location":"acces/local/#urls-locales","title":"URLs locales","text":"<ul> <li>Frontend : <code>http://mon.essensys.fr/</code> ou <code>http://&lt;ip-raspberry&gt;/</code></li> <li>API : <code>http://mon.essensys.fr/api/*</code></li> <li>Health check : <code>http://mon.essensys.fr/health</code></li> </ul>"},{"location":"acces/local/#configuration-dns-locale","title":"Configuration DNS locale","text":"<p>Pour que <code>mon.essensys.fr</code> fonctionne, configurer le DNS sur votre routeur ou utiliser <code>/etc/hosts</code>.</p>"},{"location":"acces/local/#via-etchosts","title":"Via /etc/hosts","text":"<p>Sur chaque machine qui doit acc\u00e9der au Raspberry Pi :</p> <pre><code>sudo nano /etc/hosts\n</code></pre> <p>Ajouter : <pre><code>192.168.1.101 mon.essensys.fr\n</code></pre></p>"},{"location":"acces/local/#via-routeur-dns","title":"Via routeur DNS","text":"<p>Configurer le DNS sur votre routeur pour que <code>mon.essensys.fr</code> pointe vers l'IP du Raspberry Pi.</p> <p>Voir Configuration Routeur pour plus de d\u00e9tails.</p>"},{"location":"acces/local/#test-de-lacces","title":"Test de l'acc\u00e8s","text":""},{"location":"acces/local/#test-frontend","title":"Test frontend","text":"<pre><code># Depuis un navigateur\nhttp://mon.essensys.fr/\n\n# Ou via curl\ncurl http://mon.essensys.fr/\n</code></pre>"},{"location":"acces/local/#test-api","title":"Test API","text":"<pre><code># Health check\ncurl http://mon.essensys.fr/health\n\n# API serverinfos\ncurl http://mon.essensys.fr/api/serverinfos\n</code></pre>"},{"location":"acces/local/#securite-locale","title":"S\u00e9curit\u00e9 locale","text":"<ul> <li>Pas d'authentification : L'acc\u00e8s local est ouvert (pas de mot de passe)</li> <li>HTTP uniquement : Pas de HTTPS en local</li> <li>R\u00e9seau local uniquement : Les services ne sont pas accessibles depuis Internet</li> </ul>"},{"location":"acces/local/#depannage","title":"D\u00e9pannage","text":""},{"location":"acces/local/#impossible-dacceder-au-frontend","title":"Impossible d'acc\u00e9der au frontend","text":"<ol> <li> <p>V\u00e9rifier que Nginx est d\u00e9marr\u00e9 : <pre><code>sudo systemctl status nginx\n</code></pre></p> </li> <li> <p>V\u00e9rifier que le port 80 est ouvert : <pre><code>sudo netstat -tlnp | grep :80\n</code></pre></p> </li> <li> <p>V\u00e9rifier la r\u00e9solution DNS : <pre><code>ping mon.essensys.fr\n</code></pre></p> </li> </ol>"},{"location":"acces/local/#les-api-ne-fonctionnent-pas","title":"Les API ne fonctionnent pas","text":"<ol> <li> <p>V\u00e9rifier que le backend est d\u00e9marr\u00e9 : <pre><code>sudo systemctl status essensys-backend\n</code></pre></p> </li> <li> <p>Tester directement le backend : <pre><code>curl http://localhost:7070/health\n</code></pre></p> </li> </ol>"},{"location":"acces/wan/","title":"Acc\u00e8s WAN","text":"<p>Acc\u00e8s aux services Essensys depuis Internet (WAN) avec HTTPS et authentification.</p>"},{"location":"acces/wan/#prerequis","title":"Pr\u00e9requis","text":"<ol> <li>Domaine WAN configur\u00e9 : Votre domaine doit pointer vers votre IP publique</li> <li>NAT/Port forwarding : Ports 80 et 443 redirig\u00e9s vers le Raspberry Pi</li> <li>Fichier domain.txt : Contient le domaine WAN (<code>/home/essensys/domain.txt</code>)</li> </ol>"},{"location":"acces/wan/#configuration","title":"Configuration","text":""},{"location":"acces/wan/#1-creer-le-fichier-domaintxt","title":"1. Cr\u00e9er le fichier domain.txt","text":"<pre><code>echo \"essensys.acme.com\" &gt; /home/essensys/domain.txt\n</code></pre> <p>Remplacez <code>essensys.acme.com</code> par votre domaine r\u00e9el.</p>"},{"location":"acces/wan/#2-configurer-lauthentification","title":"2. Configurer l'authentification","text":"<pre><code>sudo /etc/traefik/generate-htpasswd.sh\n</code></pre> <p>Entrer un nom d'utilisateur et un mot de passe.</p>"},{"location":"acces/wan/#3-configurer-le-natport-forwarding","title":"3. Configurer le NAT/Port forwarding","text":"<p>Configurer votre routeur pour rediriger : - Port 80 \u2192 192.168.1.101:80 - Port 443 \u2192 192.168.1.101:443</p> <p>Voir Configuration Routeur pour plus de d\u00e9tails.</p>"},{"location":"acces/wan/#urls-wan","title":"URLs WAN","text":"<ul> <li>Frontend : <code>https://essensys.acme.com/</code> (HTTPS + authentification)</li> <li>API /api/admin/inject : <code>https://essensys.acme.com/api/admin/inject</code> (HTTPS + authentification)</li> <li>Autres API : BLOQU\u00c9ES (403 Forbidden)</li> </ul>"},{"location":"acces/wan/#securite-wan","title":"S\u00e9curit\u00e9 WAN","text":""},{"location":"acces/wan/#regles-de-securite","title":"R\u00e8gles de s\u00e9curit\u00e9","text":"<ul> <li>Frontend : Accessible uniquement en HTTPS avec authentification basique</li> <li>/api/admin/inject : Accessible uniquement en HTTPS avec authentification basique</li> <li>Autres API : BLOQU\u00c9ES (ni HTTP ni HTTPS)</li> </ul>"},{"location":"acces/wan/#authentification","title":"Authentification","text":"<p>L'authentification utilise HTTP Basic Auth. Lors de l'acc\u00e8s, le navigateur demandera : - Nom d'utilisateur - Mot de passe</p>"},{"location":"acces/wan/#test-de-lacces","title":"Test de l'acc\u00e8s","text":""},{"location":"acces/wan/#test-frontend","title":"Test frontend","text":"<pre><code># Depuis un navigateur\nhttps://essensys.acme.com/\n\n# Via curl (avec authentification)\ncurl -u username:password https://essensys.acme.com/\n</code></pre>"},{"location":"acces/wan/#test-api","title":"Test API","text":"<pre><code># /api/admin/inject (avec authentification)\ncurl -u username:password -X POST https://essensys.acme.com/api/admin/inject \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"k\": 1, \"v\": \"test\"}'\n\n# Autres API (doivent \u00eatre bloqu\u00e9es)\ncurl https://essensys.acme.com/api/serverinfos\n# Devrait retourner 403 Forbidden\n</code></pre>"},{"location":"acces/wan/#certificats-ssl","title":"Certificats SSL","text":"<p>Traefik g\u00e9n\u00e8re automatiquement les certificats Let's Encrypt pour votre domaine.</p> <p>Les certificats sont stock\u00e9s dans <code>/etc/traefik/acme.json</code>.</p>"},{"location":"acces/wan/#depannage","title":"D\u00e9pannage","text":""},{"location":"acces/wan/#erreur-dns-problem-nxdomain","title":"Erreur \"DNS problem: NXDOMAIN\"","text":"<p>Le domaine WAN n'est pas correctement configur\u00e9 :</p> <ol> <li> <p>V\u00e9rifier le fichier domain.txt : <pre><code>cat /home/essensys/domain.txt\n</code></pre></p> </li> <li> <p>V\u00e9rifier que le domaine pointe vers votre IP publique : <pre><code>dig essensys.acme.com\n</code></pre></p> </li> </ol>"},{"location":"acces/wan/#erreur-de-certificat-ssl","title":"Erreur de certificat SSL","text":"<ol> <li>V\u00e9rifier que le port 443 est ouvert et redirig\u00e9</li> <li>V\u00e9rifier que le domaine pointe vers votre IP publique</li> <li>V\u00e9rifier les logs Traefik : <pre><code>sudo tail -f /var/log/traefik/traefik.log\n</code></pre></li> </ol>"},{"location":"acces/wan/#impossible-de-se-connecter","title":"Impossible de se connecter","text":"<ol> <li>V\u00e9rifier le NAT/port forwarding sur le routeur</li> <li> <p>V\u00e9rifier que Traefik est d\u00e9marr\u00e9 : <pre><code>sudo systemctl status traefik\n</code></pre></p> </li> <li> <p>V\u00e9rifier que les ports sont ouverts : <pre><code>sudo netstat -tlnp | grep -E ':(80|443)'\n</code></pre></p> </li> </ol>"},{"location":"architecture/","title":"Architecture","text":"<p>Vue d'ensemble de l'architecture Essensys sur Raspberry Pi.</p>"},{"location":"architecture/#composants","title":"Composants","text":"<ol> <li>Backend - API Go et communication avec clients legacy</li> <li>Frontend - Interface web React</li> <li>Nginx - Reverse proxy pour API locales</li> <li>Traefik - Reverse proxy pour acc\u00e8s WAN</li> <li>Ports - Ports utilis\u00e9s par les services</li> </ol>"},{"location":"architecture/#architecture-globale","title":"Architecture globale","text":"<pre><code>graph TB\n    Client[Client Essensys&lt;br/&gt;192.168.1.151]\n    BrowserLocal[Navigateur Local&lt;br/&gt;mon.essensys.fr]\n    BrowserWAN[Navigateur WAN&lt;br/&gt;essensys.acme.com]\n\n    Nginx[Nginx&lt;br/&gt;Port 80: API locales&lt;br/&gt;Port 9090: Frontend interne]\n    Traefik[Traefik&lt;br/&gt;Port 443: Frontend WAN HTTPS]\n    Backend[Backend Go&lt;br/&gt;Port 7070]\n    Frontend[Frontend React&lt;br/&gt;Fichiers statiques]\n\n    Client --&gt;|mon.essensys.fr/api/*| Nginx\n    BrowserLocal --&gt;|mon.essensys.fr/| Nginx\n    BrowserWAN --&gt;|essensys.acme.com/| Traefik\n\n    Nginx --&gt;|/api/*| Backend\n    Nginx --&gt;|/| Frontend\n    Traefik --&gt;|Frontend| Nginx\n\n    style Client fill:#e1f5ff\n    style BrowserLocal fill:#fff4e1\n    style BrowserWAN fill:#fff4e1\n    style Nginx fill:#e8f5e9\n    style Traefik fill:#e3f2fd\n    style Backend fill:#f3e5f5\n    style Frontend fill:#fff4e1</code></pre>"},{"location":"architecture/#flux-de-donnees","title":"Flux de donn\u00e9es","text":""},{"location":"architecture/#flux-local-api","title":"Flux local (API)","text":"<pre><code>sequenceDiagram\n    participant C as Client Essensys\n    participant N as Nginx Port 80\n    participant B as Backend Port 7070\n\n    C-&gt;&gt;N: GET /api/serverinfos\n    N-&gt;&gt;B: Proxy vers backend\n    B-&gt;&gt;N: R\u00e9ponse (single-packet TCP)\n    N-&gt;&gt;C: R\u00e9ponse compl\u00e8te</code></pre>"},{"location":"architecture/#flux-wan-frontend","title":"Flux WAN (Frontend)","text":"<pre><code>sequenceDiagram\n    participant U as Utilisateur WAN\n    participant T as Traefik Port 443\n    participant N as Nginx Port 9090\n    participant F as Frontend\n\n    U-&gt;&gt;T: https://essensys.acme.com/\n    T-&gt;&gt;T: Authentification Basic Auth\n    T-&gt;&gt;N: Proxy vers Nginx\n    N-&gt;&gt;F: Servir fichiers statiques\n    F-&gt;&gt;N: index.html + assets\n    N-&gt;&gt;T: R\u00e9ponse\n    T-&gt;&gt;U: Frontend React (HTTPS)</code></pre>"},{"location":"architecture/backend/","title":"Backend","text":"<p>Le backend Essensys est \u00e9crit en Go et g\u00e8re les API REST et la communication avec les clients Essensys legacy.</p>"},{"location":"architecture/backend/#caracteristiques","title":"Caract\u00e9ristiques","text":"<ul> <li>Langage : Go</li> <li>Port : 7070</li> <li>Emplacement : <code>/opt/essensys/backend/</code></li> <li>Configuration : <code>/opt/essensys/backend/config.yaml</code></li> </ul>"},{"location":"architecture/backend/#api-endpoints","title":"API Endpoints","text":"<ul> <li><code>GET /health</code> - Health check</li> <li><code>GET /api/serverinfos</code> - Informations serveur</li> <li><code>GET /api/mystatus</code> - Statut actuel</li> <li><code>POST /api/myactions</code> - Actions utilisateur</li> <li><code>POST /api/done</code> - Confirmation</li> <li><code>POST /api/admin/inject</code> - Injection de commandes</li> </ul>"},{"location":"architecture/backend/#compatibilite-client-legacy","title":"Compatibilit\u00e9 client legacy","text":"<p>Le backend est con\u00e7u pour \u00eatre compatible avec le client Essensys legacy (BP_MQX_ETH) qui : - Ne respecte pas compl\u00e8tement le standard HTTP - N\u00e9cessite des r\u00e9ponses en un seul paquet TCP - Utilise des headers HTTP non-standard</p>"},{"location":"architecture/backend/#logs","title":"Logs","text":"<p>Les logs sont disponibles dans <code>/var/logs/Essensys/backend/console.out.log</code>.</p>"},{"location":"architecture/frontend/","title":"Frontend","text":"<p>Le frontend Essensys est une application React moderne.</p>"},{"location":"architecture/frontend/#caracteristiques","title":"Caract\u00e9ristiques","text":"<ul> <li>Framework : React + TypeScript</li> <li>Build tool : Vite</li> <li>Emplacement : <code>/opt/essensys/frontend/dist/</code></li> <li>Servi par : Nginx (local) et Traefik (WAN)</li> </ul>"},{"location":"architecture/frontend/#fonctionnalites","title":"Fonctionnalit\u00e9s","text":"<ul> <li>Interface utilisateur moderne</li> <li>Configuration dynamique du backend</li> <li>D\u00e9tection automatique du domaine WAN</li> <li>Compatible avec les navigateurs modernes</li> </ul>"},{"location":"architecture/frontend/#build","title":"Build","text":"<p>Le frontend est compil\u00e9 en fichiers statiques HTML/CSS/JS et servi par Nginx.</p>"},{"location":"architecture/nginx/","title":"Nginx","text":"<p>Nginx sert de reverse proxy pour les API locales et le frontend local.</p>"},{"location":"architecture/nginx/#configuration","title":"Configuration","text":"<ul> <li>Fichier de configuration : <code>/etc/nginx/sites-available/essensys</code></li> <li>Port 80 : API locales et frontend local</li> <li>Port 9090 : Frontend interne (utilis\u00e9 par Traefik)</li> </ul>"},{"location":"architecture/nginx/#roles","title":"R\u00f4les","text":"<ol> <li>Proxy API locales : <code>/api/*</code> \u2192 Backend port 7070</li> <li>Servir frontend local : <code>/</code> \u2192 Fichiers statiques</li> <li>Compatibilit\u00e9 client legacy : Configuration sp\u00e9ciale pour single-packet TCP</li> </ol>"},{"location":"architecture/nginx/#logs","title":"Logs","text":"<ul> <li>Acc\u00e8s : <code>/var/log/nginx/essensys-access.log</code></li> <li>Erreurs : <code>/var/log/nginx/essensys-error.log</code></li> <li>API d\u00e9taill\u00e9 : <code>/var/log/nginx/essensys-api-detailed.log</code></li> </ul>"},{"location":"architecture/ports/","title":"Ports utilis\u00e9s","text":"<p>Tableau r\u00e9capitulatif des ports utilis\u00e9s par les services Essensys.</p> Service Port Protocole Description Nginx 80 TCP Frontend local + API locales Nginx 9090 TCP Frontend interne (Traefik) Backend Go 7070 TCP API backend Traefik 443 TCP Frontend WAN HTTPS Traefik 8080 TCP Dashboard Traefik Traefik 8081 TCP API interne Traefik Traefik Block Service 8082 TCP Service de blocage (403)"},{"location":"architecture/ports/#conflits-de-ports","title":"Conflits de ports","text":"<ul> <li>Le port 80 est partag\u00e9 entre Nginx (API locales) et Traefik (frontend local) gr\u00e2ce aux <code>server_name</code></li> <li>Le port 443 est exclusivement utilis\u00e9 par Traefik pour le WAN</li> <li>Le port 7070 est exclusivement utilis\u00e9 par le backend Go</li> </ul>"},{"location":"architecture/traefik/","title":"Traefik","text":"<p>Traefik est un reverse proxy avanc\u00e9 qui g\u00e8re l'acc\u00e8s WAN avec HTTPS et authentification.</p>"},{"location":"architecture/traefik/#configuration","title":"Configuration","text":"<ul> <li>Fichier principal : <code>/etc/traefik/traefik.yml</code></li> <li>Routes locales : <code>/etc/traefik/dynamic/local-routes.yml</code></li> <li>Routes WAN : <code>/etc/traefik/dynamic/wan-routes.yml</code></li> <li>Port 443 : Frontend WAN HTTPS</li> </ul>"},{"location":"architecture/traefik/#roles","title":"R\u00f4les","text":"<ol> <li>Frontend WAN : HTTPS avec authentification basique</li> <li>API /api/admin/inject WAN : HTTPS avec authentification</li> <li>Blocage autres API WAN : 403 Forbidden</li> <li>Certificats Let's Encrypt : G\u00e9n\u00e9ration automatique</li> </ol>"},{"location":"architecture/traefik/#securite","title":"S\u00e9curit\u00e9","text":"<ul> <li>Authentification HTTP Basic Auth</li> <li>HTTPS obligatoire pour WAN</li> <li>Blocage des API non autoris\u00e9es</li> </ul>"},{"location":"connexion/","title":"Connexion au Raspberry Pi","text":"<p>Cette section explique comment se connecter au Raspberry Pi et configurer le r\u00e9seau.</p>"},{"location":"connexion/#sections","title":"Sections","text":"<ol> <li>Connexion SSH - Se connecter en SSH au Raspberry Pi</li> <li>Configuration r\u00e9seau - Configurer le r\u00e9seau (DHCP ou IP statique)</li> </ol>"},{"location":"connexion/#vue-densemble","title":"Vue d'ensemble","text":"<pre><code>flowchart TD\n    A[Pr\u00e9paration mat\u00e9riel] --&gt; B[Installation OS]\n    B --&gt; C[Configuration r\u00e9seau]\n    C --&gt; D[Connexion SSH]\n    D --&gt; E[Installation Essensys]\n\n    style A fill:#e1f5ff\n    style B fill:#fff4e1\n    style C fill:#e8f5e9\n    style D fill:#f3e5f5\n    style E fill:#c8e6c9</code></pre>"},{"location":"connexion/configuration-reseau/","title":"Configuration r\u00e9seau","text":"<p>Cette section explique comment configurer le r\u00e9seau sur le Raspberry Pi (DHCP ou IP statique).</p>"},{"location":"connexion/configuration-reseau/#configuration-automatique-dhcp","title":"Configuration automatique (DHCP)","text":"<p>Par d\u00e9faut, le Raspberry Pi utilise DHCP pour obtenir automatiquement une adresse IP.</p>"},{"location":"connexion/configuration-reseau/#verifier-la-configuration-actuelle","title":"V\u00e9rifier la configuration actuelle","text":"<pre><code># Voir l'adresse IP\nip addr show eth0\n\n# Ou\nifconfig eth0\n</code></pre>"},{"location":"connexion/configuration-reseau/#redemarrer-le-service-reseau","title":"Red\u00e9marrer le service r\u00e9seau","text":"<p>Si l'interface ne fonctionne pas :</p> <pre><code>sudo systemctl restart dhcpcd\n</code></pre>"},{"location":"connexion/configuration-reseau/#configuration-ip-statique","title":"Configuration IP statique","text":""},{"location":"connexion/configuration-reseau/#methode-1-via-dhcpcdconf","title":"M\u00e9thode 1 : Via dhcpcd.conf","text":"<p>\u00c9diter <code>/etc/dhcpcd.conf</code> :</p> <pre><code>sudo nano /etc/dhcpcd.conf\n</code></pre> <p>Ajouter \u00e0 la fin du fichier :</p> <pre><code># Configuration IP statique pour eth0\ninterface eth0\nstatic ip_address=192.168.1.101/24\nstatic routers=192.168.1.1\nstatic domain_name_servers=8.8.8.8 8.8.4.4\n</code></pre> <p>Param\u00e8tres : - <code>static ip_address</code> : Adresse IP et masque (format CIDR) - <code>static routers</code> : Passerelle (routeur) - <code>static domain_name_servers</code> : Serveurs DNS</p> <p>Red\u00e9marrer le service :</p> <pre><code>sudo systemctl restart dhcpcd\n</code></pre>"},{"location":"connexion/configuration-reseau/#methode-2-via-netplan-si-disponible","title":"M\u00e9thode 2 : Via netplan (si disponible)","text":"<p>Cr\u00e9er <code>/etc/netplan/01-netcfg.yaml</code> :</p> <pre><code>network:\n  version: 2\n  renderer: networkd\n  ethernets:\n    eth0:\n      dhcp4: no\n      addresses:\n        - 192.168.1.101/24\n      gateway4: 192.168.1.1\n      nameservers:\n        addresses:\n          - 8.8.8.8\n          - 8.8.4.4\n</code></pre> <p>Appliquer la configuration :</p> <pre><code>sudo netplan apply\n</code></pre>"},{"location":"connexion/configuration-reseau/#configuration-dns","title":"Configuration DNS","text":""},{"location":"connexion/configuration-reseau/#dns-local-monessensysfr","title":"DNS local (mon.essensys.fr)","text":"<p>Pour que <code>mon.essensys.fr</code> pointe vers le Raspberry Pi, configurer le DNS sur votre routeur ou utiliser <code>/etc/hosts</code> :</p> <pre><code>sudo nano /etc/hosts\n</code></pre> <p>Ajouter : <pre><code>192.168.1.101 mon.essensys.fr\n</code></pre></p>"},{"location":"connexion/configuration-reseau/#dns-via-routeur","title":"DNS via routeur","text":"<p>Configurer le DNS sur votre routeur pour que <code>mon.essensys.fr</code> pointe vers <code>192.168.1.101</code>.</p> <p>Voir la section Configuration Routeur pour plus de d\u00e9tails.</p>"},{"location":"connexion/configuration-reseau/#depannage-reseau","title":"D\u00e9pannage r\u00e9seau","text":""},{"location":"connexion/configuration-reseau/#linterface-eth0-ne-demarre-pas","title":"L'interface eth0 ne d\u00e9marre pas","text":"<pre><code># V\u00e9rifier l'\u00e9tat de l'interface\nip link show eth0\n\n# Activer l'interface\nsudo ip link set eth0 up\n\n# Red\u00e9marrer le service\nsudo systemctl restart dhcpcd\n</code></pre>"},{"location":"connexion/configuration-reseau/#pas-dadresse-ip","title":"Pas d'adresse IP","text":"<pre><code># Forcer la demande DHCP\nsudo dhclient eth0\n\n# V\u00e9rifier les logs\nsudo journalctl -u dhcpcd -n 50\n</code></pre>"},{"location":"connexion/configuration-reseau/#probleme-de-connectivite","title":"Probl\u00e8me de connectivit\u00e9","text":"<pre><code># Tester la connectivit\u00e9\nping -c 3 8.8.8.8\n\n# Tester la r\u00e9solution DNS\nnslookup google.com\n\n# V\u00e9rifier la route\nip route show\n</code></pre>"},{"location":"connexion/configuration-reseau/#scripts-de-configuration","title":"Scripts de configuration","text":"<p>Des scripts sont fournis pour faciliter la configuration :</p>"},{"location":"connexion/configuration-reseau/#script-de-reparation-rapide","title":"Script de r\u00e9paration rapide","text":"<pre><code>cd ~/essensys-raspberry-install\nsudo ./fix-network.sh\n</code></pre>"},{"location":"connexion/configuration-reseau/#script-de-configuration-complete","title":"Script de configuration compl\u00e8te","text":"<pre><code>cd ~/essensys-raspberry-install\nsudo ./configure-network.sh\n</code></pre> <p>Le script vous demandera : - Mode DHCP ou IP statique - Adresse IP (si statique) - Masque de sous-r\u00e9seau - Passerelle - Serveurs DNS</p>"},{"location":"connexion/configuration-reseau/#prochaines-etapes","title":"Prochaines \u00e9tapes","text":"<p>Une fois le r\u00e9seau configur\u00e9 :</p> <ol> <li>Installation Essensys - Installer Essensys</li> <li>Configuration Routeur - Configurer le NAT/port forwarding</li> </ol>"},{"location":"connexion/ssh/","title":"Connexion SSH","text":"<p>Cette section explique comment se connecter au Raspberry Pi via SSH.</p>"},{"location":"connexion/ssh/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Raspberry Pi OS install\u00e9 et d\u00e9marr\u00e9</li> <li>SSH activ\u00e9 dans Raspberry Pi Imager (ou activ\u00e9 manuellement)</li> <li>Raspberry Pi connect\u00e9 au r\u00e9seau (Ethernet ou Wi-Fi)</li> <li>Adresse IP du Raspberry Pi connue</li> </ul>"},{"location":"connexion/ssh/#trouver-ladresse-ip","title":"Trouver l'adresse IP","text":""},{"location":"connexion/ssh/#methode-1-via-le-routeur","title":"M\u00e9thode 1 : Via le routeur","text":"<ol> <li>Se connecter \u00e0 l'interface d'administration du routeur</li> <li>Chercher dans la liste des appareils connect\u00e9s</li> <li>Identifier le Raspberry Pi par :</li> <li>Nom d'h\u00f4te : <code>raspberrypi</code> (par d\u00e9faut)</li> <li>Adresse MAC : Commence par <code>B8:27:EB</code>, <code>DC:A6:32</code>, ou <code>E4:5F:01</code></li> </ol>"},{"location":"connexion/ssh/#methode-2-scan-reseau","title":"M\u00e9thode 2 : Scan r\u00e9seau","text":"<p>Depuis votre ordinateur sur le m\u00eame r\u00e9seau :</p> <p>Linux/Mac : <pre><code># Scanner le r\u00e9seau local\nnmap -sn 192.168.1.0/24\n\n# Ou utiliser arp\narp -a | grep -i \"b8:27:eb\\|dc:a6:32\\|e4:5f:01\"\n</code></pre></p> <p>Windows : <pre><code># Scanner le r\u00e9seau\nnmap -sn 192.168.1.0/24\n</code></pre></p>"},{"location":"connexion/ssh/#methode-3-via-mdns-si-active","title":"M\u00e9thode 3 : Via mDNS (si activ\u00e9)","text":"<p>Si mDNS est activ\u00e9, vous pouvez utiliser le nom d'h\u00f4te :</p> <pre><code>ssh essensys@raspberrypi.local\n# ou\nssh essensys@mon.essensys.fr  # Si DNS configur\u00e9\n</code></pre>"},{"location":"connexion/ssh/#connexion-ssh_1","title":"Connexion SSH","text":""},{"location":"connexion/ssh/#connexion-basique","title":"Connexion basique","text":"<pre><code>ssh essensys@&lt;ip-raspberry&gt;\n</code></pre> <p>Exemple : <pre><code>ssh essensys@192.168.1.101\n</code></pre></p>"},{"location":"connexion/ssh/#connexion-avec-cle-ssh-recommande","title":"Connexion avec cl\u00e9 SSH (recommand\u00e9)","text":""},{"location":"connexion/ssh/#generer-une-cle-ssh-si-vous-nen-avez-pas","title":"G\u00e9n\u00e9rer une cl\u00e9 SSH (si vous n'en avez pas)","text":"<pre><code># Sur votre machine locale\nssh-keygen -t ed25519 -C \"essensys-raspberry\"\n</code></pre>"},{"location":"connexion/ssh/#copier-la-cle-publique-sur-le-raspberry-pi","title":"Copier la cl\u00e9 publique sur le Raspberry Pi","text":"<pre><code># M\u00e9thode 1 : ssh-copy-id\nssh-copy-id essensys@&lt;ip-raspberry&gt;\n\n# M\u00e9thode 2 : Manuellement\ncat ~/.ssh/id_ed25519.pub | ssh essensys@&lt;ip-raspberry&gt; \"mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys\"\n</code></pre>"},{"location":"connexion/ssh/#connexion-sans-mot-de-passe","title":"Connexion sans mot de passe","text":"<p>Une fois la cl\u00e9 copi\u00e9e, vous pouvez vous connecter sans mot de passe :</p> <pre><code>ssh essensys@&lt;ip-raspberry&gt;\n</code></pre>"},{"location":"connexion/ssh/#configuration-ssh","title":"Configuration SSH","text":""},{"location":"connexion/ssh/#modifier-le-port-ssh-optionnel","title":"Modifier le port SSH (optionnel)","text":"<p>\u00c9diter <code>/etc/ssh/sshd_config</code> :</p> <pre><code>sudo nano /etc/ssh/sshd_config\n</code></pre> <p>Changer la ligne : <pre><code>#Port 22\nPort 2222  # Nouveau port\n</code></pre></p> <p>Red\u00e9marrer SSH : <pre><code>sudo systemctl restart sshd\n</code></pre></p>"},{"location":"connexion/ssh/#desactiver-lauthentification-par-mot-de-passe-securite","title":"D\u00e9sactiver l'authentification par mot de passe (s\u00e9curit\u00e9)","text":"<p>Une fois les cl\u00e9s SSH configur\u00e9es :</p> <pre><code>sudo nano /etc/ssh/sshd_config\n</code></pre> <p>Modifier : <pre><code>PasswordAuthentication no\nPubkeyAuthentication yes\n</code></pre></p> <p>Red\u00e9marrer SSH : <pre><code>sudo systemctl restart sshd\n</code></pre></p>"},{"location":"connexion/ssh/#depannage","title":"D\u00e9pannage","text":""},{"location":"connexion/ssh/#impossible-de-se-connecter","title":"Impossible de se connecter","text":"<ol> <li> <p>V\u00e9rifier que SSH est activ\u00e9 : <pre><code># Sur le Raspberry Pi\nsudo systemctl status ssh\n</code></pre></p> </li> <li> <p>V\u00e9rifier le pare-feu : <pre><code># Sur le Raspberry Pi\nsudo ufw status\nsudo ufw allow 22/tcp  # Si n\u00e9cessaire\n</code></pre></p> </li> <li> <p>V\u00e9rifier la connexion r\u00e9seau : <pre><code># Depuis votre machine\nping &lt;ip-raspberry&gt;\n</code></pre></p> </li> <li> <p>V\u00e9rifier les logs SSH : <pre><code># Sur le Raspberry Pi\nsudo tail -f /var/log/auth.log\n</code></pre></p> </li> </ol>"},{"location":"connexion/ssh/#erreur-connection-refused","title":"Erreur \"Connection refused\"","text":"<ul> <li>V\u00e9rifier que SSH est d\u00e9marr\u00e9 : <code>sudo systemctl start ssh</code></li> <li>V\u00e9rifier que le port 22 n'est pas bloqu\u00e9 par le pare-feu</li> </ul>"},{"location":"connexion/ssh/#erreur-permission-denied","title":"Erreur \"Permission denied\"","text":"<ul> <li>V\u00e9rifier le nom d'utilisateur (par d\u00e9faut : <code>essensys</code> ou <code>pi</code>)</li> <li>V\u00e9rifier le mot de passe</li> <li>V\u00e9rifier les permissions de <code>~/.ssh/authorized_keys</code> (doit \u00eatre 600)</li> </ul>"},{"location":"connexion/ssh/#prochaines-etapes","title":"Prochaines \u00e9tapes","text":"<p>Une fois connect\u00e9 en SSH :</p> <ol> <li>Configuration r\u00e9seau - Configurer le r\u00e9seau si n\u00e9cessaire</li> <li>Installation Essensys - Installer Essensys</li> </ol>"},{"location":"installation/","title":"Installation","text":"<p>Cette section couvre toutes les \u00e9tapes d'installation, de la pr\u00e9paration du mat\u00e9riel \u00e0 l'installation compl\u00e8te d'Essensys.</p>"},{"location":"installation/#etapes-dinstallation","title":"\u00c9tapes d'installation","text":"<ol> <li>Pr\u00e9paration du mat\u00e9riel - Mat\u00e9riel n\u00e9cessaire et pr\u00e9paration</li> <li>Installation de l'OS - Installation de Raspberry Pi OS sur le SSD</li> <li>Installation Essensys - D\u00e9ploiement du backend et frontend</li> </ol>"},{"location":"installation/#vue-densemble","title":"Vue d'ensemble","text":"<pre><code>flowchart TD\n    A[Pr\u00e9paration mat\u00e9riel] --&gt; B[Installation OS]\n    B --&gt; C[Configuration r\u00e9seau]\n    C --&gt; D[Installation Essensys]\n    D --&gt; E[Configuration Nginx]\n    E --&gt; F[Configuration Traefik optionnel]\n    F --&gt; G[Services d\u00e9marr\u00e9s]\n\n    style A fill:#e1f5ff\n    style B fill:#fff4e1\n    style C fill:#e8f5e9\n    style D fill:#f3e5f5\n    style E fill:#e3f2fd\n    style F fill:#e3f2fd\n    style G fill:#c8e6c9</code></pre>"},{"location":"installation/essensys-installation/","title":"Installation Essensys","text":"<p>Cette section explique comment installer Essensys (backend et frontend) sur le Raspberry Pi.</p>"},{"location":"installation/essensys-installation/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Raspberry Pi OS install\u00e9 et fonctionnel</li> <li>Connexion SSH \u00e9tablie (voir Connexion SSH)</li> <li>Acc\u00e8s Internet sur le Raspberry Pi</li> </ul>"},{"location":"installation/essensys-installation/#installation-automatique","title":"Installation automatique","text":""},{"location":"installation/essensys-installation/#etape-1-cloner-le-depot-dinstallation","title":"\u00c9tape 1 : Cloner le d\u00e9p\u00f4t d'installation","text":"<pre><code>cd /home/essensys\ngit clone https://github.com/essensys-hub/essensys-raspberry-install.git\ncd essensys-raspberry-install\n</code></pre>"},{"location":"installation/essensys-installation/#etape-2-executer-le-script-dinstallation","title":"\u00c9tape 2 : Ex\u00e9cuter le script d'installation","text":"<pre><code>chmod +x install.sh\nsudo ./install.sh\n</code></pre> <p>Le script va :</p> <ol> <li>Mettre \u00e0 jour le syst\u00e8me (<code>apt update &amp;&amp; apt upgrade</code>)</li> <li>Installer les d\u00e9pendances :</li> <li>Go (langage du backend)</li> <li>Node.js et npm (pour le frontend)</li> <li>Nginx (reverse proxy)</li> <li>Git</li> <li>Cloner les d\u00e9p\u00f4ts :</li> <li><code>essensys-server-backend</code> dans <code>/home/essensys/essensys-server-backend</code></li> <li><code>essensys-server-frontend</code> dans <code>/home/essensys/essensys-server-frontend</code></li> <li>Compiler le backend :</li> <li>R\u00e9soudre les d\u00e9pendances Go (<code>go mod tidy</code>)</li> <li>Compiler le binaire</li> <li>Copier dans <code>/opt/essensys/backend/</code></li> <li>Compiler le frontend :</li> <li>Installer les d\u00e9pendances npm</li> <li>Builder l'application React</li> <li>Copier dans <code>/opt/essensys/frontend/</code></li> <li>Configurer Nginx :</li> <li>Cr\u00e9er la configuration pour servir le frontend et proxy les API</li> <li>Activer le site Essensys</li> <li>Configurer Traefik (optionnel) :</li> <li>T\u00e9l\u00e9charger et installer Traefik</li> <li>Configurer les routes locales et WAN</li> <li>Lire le domaine WAN depuis <code>/home/essensys/domain.txt</code></li> <li>Cr\u00e9er les services systemd :</li> <li><code>essensys-backend.service</code></li> <li><code>essensys-frontend.service</code></li> <li><code>traefik.service</code> (si install\u00e9)</li> <li><code>traefik-block-service.service</code> (si install\u00e9)</li> </ol>"},{"location":"installation/essensys-installation/#etape-3-configuration-du-domaine-wan-si-traefik-installe","title":"\u00c9tape 3 : Configuration du domaine WAN (si Traefik install\u00e9)","text":"<p>Si vous souhaitez utiliser Traefik pour l'acc\u00e8s WAN :</p> <pre><code>echo \"essensys.acme.com\" &gt; /home/essensys/domain.txt\n</code></pre> <p>Remplacez <code>essensys.acme.com</code> par votre domaine WAN r\u00e9el.</p>"},{"location":"installation/essensys-installation/#etape-4-configuration-de-lauthentification-wan-si-traefik-installe","title":"\u00c9tape 4 : Configuration de l'authentification WAN (si Traefik install\u00e9)","text":"<p>Cr\u00e9er un utilisateur pour l'authentification basique :</p> <pre><code>sudo /etc/traefik/generate-htpasswd.sh\n</code></pre> <p>Entrer un nom d'utilisateur et un mot de passe.</p>"},{"location":"installation/essensys-installation/#verification-de-linstallation","title":"V\u00e9rification de l'installation","text":""},{"location":"installation/essensys-installation/#verifier-les-services","title":"V\u00e9rifier les services","text":"<pre><code># V\u00e9rifier le statut des services\nsudo systemctl status essensys-backend\nsudo systemctl status essensys-frontend\nsudo systemctl status nginx\nsudo systemctl status traefik  # Si install\u00e9\n</code></pre>"},{"location":"installation/essensys-installation/#verifier-les-ports","title":"V\u00e9rifier les ports","text":"<pre><code># V\u00e9rifier que les ports sont en \u00e9coute\nsudo netstat -tlnp | grep -E '7070|80|443|9090'\n</code></pre> <p>Vous devriez voir : - Port 7070 : Backend Go - Port 80 : Nginx - Port 443 : Traefik (si install\u00e9) - Port 9090 : Frontend interne (si Traefik install\u00e9)</p>"},{"location":"installation/essensys-installation/#tester-lacces-local","title":"Tester l'acc\u00e8s local","text":"<p>Depuis un navigateur sur le m\u00eame r\u00e9seau :</p> <ul> <li>Frontend : <code>http://mon.essensys.fr/</code> ou <code>http://&lt;ip-raspberry&gt;/</code></li> <li>API : <code>http://mon.essensys.fr/api/serverinfos</code></li> </ul>"},{"location":"installation/essensys-installation/#architecture-installee","title":"Architecture install\u00e9e","text":"<pre><code>graph TB\n    Client[Client Essensys&lt;br/&gt;192.168.1.151]\n    BrowserLocal[Navigateur Local&lt;br/&gt;mon.essensys.fr]\n    BrowserWAN[Navigateur WAN&lt;br/&gt;essensys.acme.com]\n\n    Nginx[Nginx&lt;br/&gt;Port 80: API locales&lt;br/&gt;Port 9090: Frontend interne]\n    Traefik[Traefik&lt;br/&gt;Port 443: Frontend WAN HTTPS]\n    Backend[Backend Go&lt;br/&gt;Port 7070]\n    Frontend[Frontend React&lt;br/&gt;/opt/essensys/frontend/dist]\n\n    Client --&gt;|mon.essensys.fr/api/*| Nginx\n    BrowserLocal --&gt;|mon.essensys.fr/| Nginx\n    BrowserWAN --&gt;|essensys.acme.com/| Traefik\n\n    Nginx --&gt;|/api/*| Backend\n    Nginx --&gt;|/| Frontend\n    Traefik --&gt;|Frontend| Nginx\n\n    style Client fill:#e1f5ff\n    style BrowserLocal fill:#fff4e1\n    style BrowserWAN fill:#fff4e1\n    style Nginx fill:#e8f5e9\n    style Traefik fill:#e3f2fd\n    style Backend fill:#f3e5f5\n    style Frontend fill:#fff4e1</code></pre>"},{"location":"installation/essensys-installation/#structure-des-fichiers-installes","title":"Structure des fichiers install\u00e9s","text":"<pre><code>/opt/essensys/\n\u251c\u2500\u2500 backend/\n\u2502   \u251c\u2500\u2500 server          # Binaire Go compil\u00e9\n\u2502   \u2514\u2500\u2500 config.yaml     # Configuration backend\n\u2514\u2500\u2500 frontend/\n    \u2514\u2500\u2500 dist/           # Fichiers React compil\u00e9s\n\n/etc/nginx/\n\u2514\u2500\u2500 sites-available/\n    \u2514\u2500\u2500 essensys        # Configuration Nginx\n\n/etc/traefik/           # Configuration Traefik (si install\u00e9)\n\u251c\u2500\u2500 traefik.yml\n\u2514\u2500\u2500 dynamic/\n    \u251c\u2500\u2500 local-routes.yml\n    \u2514\u2500\u2500 wan-routes.yml\n\n/etc/systemd/system/\n\u251c\u2500\u2500 essensys-backend.service\n\u251c\u2500\u2500 essensys-frontend.service\n\u251c\u2500\u2500 traefik.service\n\u2514\u2500\u2500 traefik-block-service.service\n\n/var/logs/Essensys/\n\u2514\u2500\u2500 backend/\n    \u2514\u2500\u2500 console.out.log\n</code></pre>"},{"location":"installation/essensys-installation/#prochaines-etapes","title":"Prochaines \u00e9tapes","text":"<p>Une fois l'installation termin\u00e9e :</p> <ol> <li>Configuration r\u00e9seau - Configurer DNS et r\u00e9seau</li> <li>Configuration routeur - Configurer le NAT/port forwarding</li> <li>Acc\u00e8s local - Tester l'acc\u00e8s local</li> <li>Acc\u00e8s WAN - Configurer l'acc\u00e8s WAN</li> </ol>"},{"location":"installation/essensys-installation/#depannage","title":"D\u00e9pannage","text":""},{"location":"installation/essensys-installation/#les-services-ne-demarrent-pas","title":"Les services ne d\u00e9marrent pas","text":"<pre><code># V\u00e9rifier les logs\nsudo journalctl -u essensys-backend -n 50\nsudo journalctl -u essensys-frontend -n 50\nsudo journalctl -u nginx -n 50\n</code></pre>"},{"location":"installation/essensys-installation/#erreur-de-compilation-go","title":"Erreur de compilation Go","text":"<pre><code>cd /home/essensys/essensys-server-backend\ngo mod tidy\ngo build -o server ./cmd/server\n</code></pre>"},{"location":"installation/essensys-installation/#erreur-de-build-frontend","title":"Erreur de build frontend","text":"<pre><code>cd /home/essensys/essensys-server-frontend\nnpm install\nnpm run build\n</code></pre>"},{"location":"installation/essensys-installation/#port-deja-utilise","title":"Port d\u00e9j\u00e0 utilis\u00e9","text":"<pre><code># Trouver le processus utilisant le port\nsudo lsof -i :7070\nsudo lsof -i :80\nsudo lsof -i :443\n\n# Arr\u00eater le processus si n\u00e9cessaire\nsudo kill &lt;PID&gt;\n</code></pre>"},{"location":"installation/os-installation/","title":"Installation de l'OS sur le SSD","text":"<p>Cette section explique comment installer Raspberry Pi OS sur le SSD connect\u00e9 via l'adaptateur USB-SATA.</p>"},{"location":"installation/os-installation/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Mat\u00e9riel pr\u00e9par\u00e9 (voir Pr\u00e9paration du mat\u00e9riel)</li> <li>Raspberry Pi Imager install\u00e9</li> <li>SSD connect\u00e9 \u00e0 l'ordinateur via l'adaptateur USB-SATA</li> </ul>"},{"location":"installation/os-installation/#etapes-dinstallation","title":"\u00c9tapes d'installation","text":""},{"location":"installation/os-installation/#etape-1-lancer-raspberry-pi-imager","title":"\u00c9tape 1 : Lancer Raspberry Pi Imager","text":"<ol> <li>Ouvrir Raspberry Pi Imager</li> <li>Cliquer sur \"CHOOSE OS\" (Choisir l'OS)</li> </ol>"},{"location":"installation/os-installation/#etape-2-selectionner-los","title":"\u00c9tape 2 : S\u00e9lectionner l'OS","text":"<ol> <li>Choisir \"Raspberry Pi OS (64-bit)\" (recommand\u00e9)</li> <li>Ou \"Raspberry Pi OS (32-bit)\" si n\u00e9cessaire</li> <li>Cliquer sur \"CHOOSE STORAGE\" (Choisir le stockage)</li> </ol>"},{"location":"installation/os-installation/#etape-3-selectionner-le-ssd","title":"\u00c9tape 3 : S\u00e9lectionner le SSD","text":"<ol> <li>Dans la liste des p\u00e9riph\u00e9riques, s\u00e9lectionner le SSD (pas la carte microSD)</li> <li>V\u00e9rifier la capacit\u00e9 du disque (doit correspondre \u00e0 votre SSD)</li> </ol> <p>Attention</p> <p>Assurez-vous de s\u00e9lectionner le bon p\u00e9riph\u00e9rique. Toutes les donn\u00e9es sur le disque s\u00e9lectionn\u00e9 seront effac\u00e9es.</p>"},{"location":"installation/os-installation/#etape-4-configurer-los-optionnel-mais-recommande","title":"\u00c9tape 4 : Configurer l'OS (optionnel mais recommand\u00e9)","text":"<p>Cliquer sur l'ic\u00f4ne d'engrenage (\u2699\ufe0f) pour ouvrir les options avanc\u00e9es :</p>"},{"location":"installation/os-installation/#options-generales","title":"Options g\u00e9n\u00e9rales","text":"<ul> <li>Activer SSH : \u2705 Cocher \"Enable SSH\"</li> <li>Utiliser l'authentification par cl\u00e9 publique (recommand\u00e9)</li> <li> <p>Ou d\u00e9finir un mot de passe pour l'utilisateur <code>pi</code></p> </li> <li> <p>Nom d'utilisateur et mot de passe :</p> </li> <li>Nom d'utilisateur : <code>essensys</code> (recommand\u00e9)</li> <li> <p>Mot de passe : D\u00e9finir un mot de passe fort</p> </li> <li> <p>Configurer le Wi-Fi (optionnel) :</p> </li> <li>SSID : Nom de votre r\u00e9seau Wi-Fi</li> <li>Mot de passe : Mot de passe Wi-Fi</li> <li> <p>Pays : S\u00e9lectionner votre pays</p> </li> <li> <p>Configurer les param\u00e8tres r\u00e9gionaux :</p> </li> <li>Timezone : <code>Europe/Paris</code> (ou votre fuseau horaire)</li> <li>Keyboard layout : <code>fr</code> (ou votre disposition de clavier)</li> </ul>"},{"location":"installation/os-installation/#options-avancees","title":"Options avanc\u00e9es","text":"<ul> <li>Activer le bureau : D\u00e9sactiv\u00e9 (mode headless recommand\u00e9)</li> <li>Activer l'\u00e9cran de d\u00e9marrage : Activ\u00e9</li> </ul>"},{"location":"installation/os-installation/#etape-5-ecrire-limage-sur-le-ssd","title":"\u00c9tape 5 : \u00c9crire l'image sur le SSD","text":"<ol> <li>Cliquer sur \"WRITE\" (\u00c9crire)</li> <li>Confirmer l'op\u00e9ration (toutes les donn\u00e9es seront effac\u00e9es)</li> <li>Attendre la fin de l'\u00e9criture (peut prendre 10-30 minutes selon la taille du SSD)</li> </ol>"},{"location":"installation/os-installation/#etape-6-verification","title":"\u00c9tape 6 : V\u00e9rification","text":"<p>Une fois l'\u00e9criture termin\u00e9e :</p> <ol> <li>\u00c9jecter le SSD proprement depuis votre ordinateur</li> <li>D\u00e9connecter l'adaptateur USB-SATA du SSD</li> <li>Brancher le SSD au Raspberry Pi via l'adaptateur USB-SATA</li> </ol>"},{"location":"installation/os-installation/#installation-sur-le-raspberry-pi","title":"Installation sur le Raspberry Pi","text":""},{"location":"installation/os-installation/#etape-1-brancher-le-materiel","title":"\u00c9tape 1 : Brancher le mat\u00e9riel","text":"<ol> <li>Connecter le SSD au Raspberry Pi via l'adaptateur USB-SATA</li> <li>Utiliser un port USB 3.0 (bleu) si disponible</li> <li>Connecter le c\u00e2ble Ethernet au Raspberry Pi</li> <li>Connecter l'alimentation au Raspberry Pi</li> </ol>"},{"location":"installation/os-installation/#etape-2-premier-demarrage","title":"\u00c9tape 2 : Premier d\u00e9marrage","text":"<ol> <li>Allumer le Raspberry Pi</li> <li>Attendre 1-2 minutes pour le d\u00e9marrage complet</li> <li>Les LEDs du Raspberry Pi doivent clignoter normalement</li> </ol>"},{"location":"installation/os-installation/#etape-3-verifier-la-connexion-reseau","title":"\u00c9tape 3 : V\u00e9rifier la connexion r\u00e9seau","text":"<p>Depuis votre ordinateur, trouver l'adresse IP du Raspberry Pi :</p> <p>Sur le m\u00eame r\u00e9seau local :</p> <pre><code># Linux/Mac\narp -a | grep -i \"b8:27:eb\\|dc:a6:32\\|e4:5f:01\"\n\n# Ou scanner le r\u00e9seau\nnmap -sn 192.168.1.0/24\n</code></pre> <p>Via le routeur : - Se connecter \u00e0 l'interface d'administration du routeur - Chercher les appareils connect\u00e9s - Identifier le Raspberry Pi par son nom d'h\u00f4te ou adresse MAC</p>"},{"location":"installation/os-installation/#images-de-reference","title":"Images de r\u00e9f\u00e9rence","text":"<p>Les images suivantes montrent les \u00e9tapes d\u00e9taill\u00e9es de l'installation :</p> <ul> <li> - S\u00e9lection de l'OS</li> <li> - S\u00e9lection du stockage</li> <li> - Configuration SSH</li> <li> - Configuration utilisateur</li> <li> - Configuration Wi-Fi</li> <li> - Options avanc\u00e9es</li> <li> - \u00c9criture en cours</li> <li> - \u00c9criture termin\u00e9e</li> </ul>"},{"location":"installation/os-installation/#prochaines-etapes","title":"Prochaines \u00e9tapes","text":"<p>Une fois l'OS install\u00e9 et le Raspberry Pi d\u00e9marr\u00e9 :</p> <ol> <li>Connexion SSH - Se connecter au Raspberry Pi</li> <li>Configuration r\u00e9seau - Configurer le r\u00e9seau</li> <li>Installation Essensys - Installer Essensys</li> </ol>"},{"location":"installation/os-installation/#depannage","title":"D\u00e9pannage","text":""},{"location":"installation/os-installation/#le-raspberry-pi-ne-demarre-pas","title":"Le Raspberry Pi ne d\u00e9marre pas","text":"<ul> <li>V\u00e9rifier que l'alimentation est suffisante (5V, 3A minimum)</li> <li>V\u00e9rifier que le SSD est correctement connect\u00e9</li> <li>V\u00e9rifier les LEDs du Raspberry Pi</li> </ul>"},{"location":"installation/os-installation/#impossible-de-se-connecter-en-ssh","title":"Impossible de se connecter en SSH","text":"<ul> <li>V\u00e9rifier que SSH est activ\u00e9 dans les options de Raspberry Pi Imager</li> <li>V\u00e9rifier que le Raspberry Pi est sur le m\u00eame r\u00e9seau</li> <li>V\u00e9rifier le pare-feu du routeur</li> </ul>"},{"location":"installation/os-installation/#le-ssd-nest-pas-detecte","title":"Le SSD n'est pas d\u00e9tect\u00e9","text":"<ul> <li>V\u00e9rifier que l'adaptateur USB-SATA est compatible USB 3.0</li> <li>Essayer un autre port USB sur le Raspberry Pi</li> <li>V\u00e9rifier que le SSD est correctement format\u00e9</li> </ul>"},{"location":"installation/preparation/","title":"Pr\u00e9paration du mat\u00e9riel","text":""},{"location":"installation/preparation/#materiel-necessaire","title":"Mat\u00e9riel n\u00e9cessaire","text":""},{"location":"installation/preparation/#composants-requis","title":"Composants requis","text":"<ol> <li>Raspberry Pi 4 (4 Go minimum recommand\u00e9)</li> <li>Acheter sur Amazon</li> <li> <p>Mod\u00e8le 4 Go ou 8 Go recommand\u00e9</p> </li> <li> <p>SSD SATA (minimum 64 Go recommand\u00e9)</p> </li> <li>Lexar SSD SATA 240 Go</li> <li> <p>Un SSD am\u00e9liore consid\u00e9rablement les performances par rapport \u00e0 une carte SD</p> </li> <li> <p>Adaptateur USB vers SATA</p> </li> <li>Adaptateur USB 3.0 vers SATA</li> <li> <p>N\u00e9cessaire pour connecter le SSD au Raspberry Pi</p> </li> <li> <p>Alimentation</p> </li> <li>Alimentation officielle Raspberry Pi 4 (5V, 3A minimum)</li> <li> <p>Important pour la stabilit\u00e9 du syst\u00e8me</p> </li> <li> <p>C\u00e2ble Ethernet</p> </li> <li> <p>Pour la connexion r\u00e9seau (recommand\u00e9 pour la stabilit\u00e9)</p> </li> <li> <p>Carte microSD (optionnelle, pour l'installation initiale)</p> </li> <li>Minimum 8 Go, classe 10</li> </ol>"},{"location":"installation/preparation/#preparation-du-ssd","title":"Pr\u00e9paration du SSD","text":""},{"location":"installation/preparation/#etape-1-brancher-le-ssd-a-ladaptateur-usb","title":"\u00c9tape 1 : Brancher le SSD \u00e0 l'adaptateur USB","text":"<ol> <li>Connecter le SSD SATA \u00e0 l'adaptateur USB-SATA</li> <li>Brancher l'adaptateur \u00e0 votre ordinateur via USB</li> </ol>"},{"location":"installation/preparation/#etape-2-verifier-la-detection","title":"\u00c9tape 2 : V\u00e9rifier la d\u00e9tection","text":"<p>Sur Windows : - Ouvrir le Gestionnaire de disques - V\u00e9rifier que le SSD est d\u00e9tect\u00e9</p> <p>Sur Linux/Mac : <pre><code>lsblk  # Linux\ndiskutil list  # Mac\n</code></pre></p>"},{"location":"installation/preparation/#logiciel-necessaire","title":"Logiciel n\u00e9cessaire","text":""},{"location":"installation/preparation/#raspberry-pi-imager","title":"Raspberry Pi Imager","text":"<p>T\u00e9l\u00e9charger et installer Raspberry Pi Imager depuis le site officiel :</p> <ul> <li>Site officiel : https://www.raspberrypi.com/software/</li> <li>Documentation fran\u00e7aise : Disponible sur le site officiel</li> </ul>"},{"location":"installation/preparation/#installation","title":"Installation","text":"<p>Windows : - T\u00e9l\u00e9charger l'installateur <code>.exe</code> - Ex\u00e9cuter l'installateur et suivre les instructions</p> <p>macOS : - T\u00e9l\u00e9charger le fichier <code>.dmg</code> - Ouvrir le fichier et glisser l'application dans Applications</p> <p>Linux : <pre><code># Ubuntu/Debian\nsudo apt update\nsudo apt install rpi-imager\n\n# Ou t\u00e9l\u00e9charger depuis le site officiel\n</code></pre></p>"},{"location":"installation/preparation/#verification-avant-installation","title":"V\u00e9rification avant installation","text":"<p>Avant de proc\u00e9der \u00e0 l'installation de l'OS, v\u00e9rifier :</p> <ul> <li>[ ] SSD correctement connect\u00e9 et d\u00e9tect\u00e9</li> <li>[ ] Raspberry Pi Imager install\u00e9</li> <li>[ ] Alimentation Raspberry Pi disponible</li> <li>[ ] C\u00e2ble Ethernet disponible</li> <li>[ ] Carte microSD (si n\u00e9cessaire pour l'installation initiale)</li> </ul>"},{"location":"installation/preparation/#prochaines-etapes","title":"Prochaines \u00e9tapes","text":"<p>Une fois le mat\u00e9riel pr\u00e9par\u00e9, passer \u00e0 l'installation de l'OS.</p>"},{"location":"logs/","title":"Logs","text":"<p>Cette section explique comment consulter et analyser les logs des diff\u00e9rents composants.</p>"},{"location":"logs/#sections","title":"Sections","text":"<ol> <li>Logs Backend - Logs du backend Go</li> <li>Logs Nginx - Logs du serveur web Nginx</li> <li>Logs Traefik - Logs du reverse proxy Traefik</li> </ol>"},{"location":"logs/#vue-densemble-des-emplacements","title":"Vue d'ensemble des emplacements","text":"Composant Fichier de log Commande Backend <code>/var/logs/Essensys/backend/console.out.log</code> <code>sudo tail -f /var/logs/Essensys/backend/console.out.log</code> Nginx (acc\u00e8s) <code>/var/log/nginx/essensys-access.log</code> <code>sudo tail -f /var/log/nginx/essensys-access.log</code> Nginx (erreurs) <code>/var/log/nginx/essensys-error.log</code> <code>sudo tail -f /var/log/nginx/essensys-error.log</code> Nginx (API d\u00e9taill\u00e9) <code>/var/log/nginx/essensys-api-detailed.log</code> <code>sudo tail -f /var/log/nginx/essensys-api-detailed.log</code> Traefik <code>/var/log/traefik/traefik.log</code> <code>sudo tail -f /var/log/traefik/traefik.log</code> Traefik (acc\u00e8s) <code>/var/log/traefik/access.log</code> <code>sudo tail -f /var/log/traefik/access.log</code>"},{"location":"logs/#scripts-utiles","title":"Scripts utiles","text":"<p>Des scripts sont fournis pour faciliter la consultation des logs :</p> <pre><code># Voir les logs API d\u00e9taill\u00e9s\n./view-api-logs.sh -f\n\n# Voir les logs Traefik\n./traefik-config/view-traefik-logs.sh\n</code></pre>"},{"location":"logs/backend/","title":"Logs Backend","text":"<p>Les logs du backend Go sont \u00e9crits dans <code>/var/logs/Essensys/backend/console.out.log</code>.</p>"},{"location":"logs/backend/#consultation-des-logs","title":"Consultation des logs","text":""},{"location":"logs/backend/#voir-les-logs-en-temps-reel","title":"Voir les logs en temps r\u00e9el","text":"<pre><code>sudo tail -f /var/logs/Essensys/backend/console.out.log\n</code></pre>"},{"location":"logs/backend/#voir-les-dernieres-lignes","title":"Voir les derni\u00e8res lignes","text":"<pre><code># 50 derni\u00e8res lignes\nsudo tail -n 50 /var/logs/Essensys/backend/console.out.log\n\n# 100 derni\u00e8res lignes\nsudo tail -n 100 /var/logs/Essensys/backend/console.out.log\n</code></pre>"},{"location":"logs/backend/#voir-tout-le-fichier","title":"Voir tout le fichier","text":"<pre><code>sudo cat /var/logs/Essensys/backend/console.out.log\n</code></pre>"},{"location":"logs/backend/#rechercher-dans-les-logs","title":"Rechercher dans les logs","text":"<pre><code># Rechercher une erreur\nsudo grep -i \"error\" /var/logs/Essensys/backend/console.out.log\n\n# Rechercher une IP\nsudo grep \"192.168.1.151\" /var/logs/Essensys/backend/console.out.log\n</code></pre>"},{"location":"logs/backend/#logs-via-journalctl","title":"Logs via journalctl","text":"<p>Les logs sont \u00e9galement disponibles via <code>journalctl</code> :</p> <pre><code># Voir les logs en temps r\u00e9el\nsudo journalctl -u essensys-backend -f\n\n# Voir les derni\u00e8res lignes\nsudo journalctl -u essensys-backend -n 50\n\n# Voir les logs depuis une date\nsudo journalctl -u essensys-backend --since \"2024-01-01\"\n</code></pre>"},{"location":"logs/backend/#vider-les-logs","title":"Vider les logs","text":"<p>Si n\u00e9cessaire, vous pouvez vider les logs :</p> <pre><code>sudo truncate -s 0 /var/logs/Essensys/backend/console.out.log\n</code></pre> <p>Attention</p> <p>Vider les logs supprime toutes les informations. Assurez-vous d'avoir sauvegard\u00e9 les logs importants avant de les vider.</p>"},{"location":"logs/backend/#format-des-logs","title":"Format des logs","text":"<p>Les logs du backend incluent : - Timestamp (date et heure) - Niveau de log (INFO, WARN, ERROR, DEBUG) - Message de log - Informations sur les requ\u00eates (IP source, endpoint, etc.)</p> <p>Exemple : <pre><code>2024/01/02 17:19:30 [INFO] Server started on port 7070\n2024/01/02 17:19:35 [INFO] Received request from 192.168.1.151: /api/serverinfos\n2024/01/02 17:19:35 [ERROR] Failed to process request: invalid format\n</code></pre></p>"},{"location":"logs/backend/#depannage","title":"D\u00e9pannage","text":""},{"location":"logs/backend/#les-logs-ne-sont-pas-crees","title":"Les logs ne sont pas cr\u00e9\u00e9s","text":"<ol> <li> <p>V\u00e9rifier que le service est d\u00e9marr\u00e9 : <pre><code>sudo systemctl status essensys-backend\n</code></pre></p> </li> <li> <p>V\u00e9rifier les permissions : <pre><code>ls -la /var/logs/Essensys/backend/\n</code></pre></p> </li> <li> <p>V\u00e9rifier que le r\u00e9pertoire existe : <pre><code>sudo mkdir -p /var/logs/Essensys/backend\nsudo chown essensys:essensys /var/logs/Essensys/backend\n</code></pre></p> </li> </ol>"},{"location":"logs/backend/#les-logs-sont-vides","title":"Les logs sont vides","text":"<ul> <li>V\u00e9rifier que le backend re\u00e7oit des requ\u00eates</li> <li>V\u00e9rifier la configuration du backend dans <code>/opt/essensys/backend/config.yaml</code></li> </ul>"},{"location":"logs/nginx/","title":"Logs Nginx","text":"<p>Nginx g\u00e9n\u00e8re plusieurs fichiers de logs pour diff\u00e9rents types d'informations.</p>"},{"location":"logs/nginx/#fichiers-de-logs","title":"Fichiers de logs","text":""},{"location":"logs/nginx/#logs-generaux","title":"Logs g\u00e9n\u00e9raux","text":"<ul> <li>Acc\u00e8s : <code>/var/log/nginx/essensys-access.log</code></li> <li>Erreurs : <code>/var/log/nginx/essensys-error.log</code></li> </ul>"},{"location":"logs/nginx/#logs-api-detailles-diagnostic-client-legacy","title":"Logs API d\u00e9taill\u00e9s (diagnostic client legacy)","text":"<ul> <li>D\u00e9taill\u00e9 : <code>/var/log/nginx/essensys-api-detailed.log</code></li> <li>Trace : <code>/var/log/nginx/essensys-api-trace.log</code></li> <li>Erreurs API : <code>/var/log/nginx/essensys-api-error.log</code></li> </ul>"},{"location":"logs/nginx/#consultation-des-logs","title":"Consultation des logs","text":""},{"location":"logs/nginx/#logs-dacces-generaux","title":"Logs d'acc\u00e8s g\u00e9n\u00e9raux","text":"<pre><code># Voir en temps r\u00e9el\nsudo tail -f /var/log/nginx/essensys-access.log\n\n# Derni\u00e8res lignes\nsudo tail -n 100 /var/log/nginx/essensys-access.log\n</code></pre>"},{"location":"logs/nginx/#logs-derreur","title":"Logs d'erreur","text":"<pre><code># Voir en temps r\u00e9el\nsudo tail -f /var/log/nginx/essensys-error.log\n\n# Rechercher les erreurs\nsudo grep -i \"error\" /var/log/nginx/essensys-error.log\n</code></pre>"},{"location":"logs/nginx/#logs-api-detailles","title":"Logs API d\u00e9taill\u00e9s","text":"<pre><code># Voir en temps r\u00e9el\nsudo tail -f /var/log/nginx/essensys-api-detailed.log\n\n# Voir les traces\nsudo tail -f /var/log/nginx/essensys-api-trace.log\n</code></pre>"},{"location":"logs/nginx/#script-de-visualisation","title":"Script de visualisation","text":"<p>Un script est fourni pour faciliter la consultation des logs API :</p> <pre><code># Suivre tous les logs API en temps r\u00e9el\n./view-api-logs.sh -f\n\n# Afficher les 100 derni\u00e8res requ\u00eates mystatus\n./view-api-logs.sh -m -n 100\n\n# Afficher les erreurs\n./view-api-logs.sh -e\n\n# Suivre les requ\u00eates serverinfos en temps r\u00e9el\n./view-api-logs.sh -s -f\n\n# Filtrer les requ\u00eates myactions\n./view-api-logs.sh -a\n\n# Filtrer les requ\u00eates done\n./view-api-logs.sh -d\n\n# Filtrer les requ\u00eates admin/inject\n./view-api-logs.sh -i\n</code></pre>"},{"location":"logs/nginx/#format-des-logs","title":"Format des logs","text":""},{"location":"logs/nginx/#logs-dacces-standard","title":"Logs d'acc\u00e8s standard","text":"<p>Format : <code>combined</code> (par d\u00e9faut)</p> <pre><code>192.168.1.151 - - [02/Jan/2024:17:19:35 +0000] \"GET /api/serverinfos HTTP/1.0\" 200 1234 \"-\" \"-\"\n</code></pre>"},{"location":"logs/nginx/#logs-api-detailles_1","title":"Logs API d\u00e9taill\u00e9s","text":"<p>Format : <code>essensys_api_detailed</code></p> <p>Inclut : - Adresse IP source - M\u00e9thode HTTP et URI compl\u00e8te - Temps de r\u00e9ponse (request_time, upstream_connect_time, upstream_response_time) - Headers HTTP (Content-Type, Content-Length, Connection) - Informations upstream (adresse, statut, taille de r\u00e9ponse)</p>"},{"location":"logs/nginx/#analyse-des-logs","title":"Analyse des logs","text":""},{"location":"logs/nginx/#compter-les-requetes-par-ip","title":"Compter les requ\u00eates par IP","text":"<pre><code>sudo awk '{print $1}' /var/log/nginx/essensys-access.log | sort | uniq -c | sort -rn\n</code></pre>"},{"location":"logs/nginx/#compter-les-requetes-par-endpoint","title":"Compter les requ\u00eates par endpoint","text":"<pre><code>sudo awk '{print $7}' /var/log/nginx/essensys-access.log | sort | uniq -c | sort -rn\n</code></pre>"},{"location":"logs/nginx/#voir-les-erreurs-4xx-et-5xx","title":"Voir les erreurs 4xx et 5xx","text":"<pre><code>sudo awk '$9 ~ /^[45]/ {print}' /var/log/nginx/essensys-access.log\n</code></pre>"},{"location":"logs/nginx/#rotation-des-logs","title":"Rotation des logs","text":"<p>Les logs Nginx sont automatiquement rotat\u00e9s par <code>logrotate</code>. La configuration se trouve dans <code>/etc/logrotate.d/nginx</code>.</p> <p>Pour forcer une rotation manuelle :</p> <pre><code>sudo logrotate -f /etc/logrotate.d/nginx\n</code></pre>"},{"location":"logs/nginx/#depannage","title":"D\u00e9pannage","text":""},{"location":"logs/nginx/#les-logs-ne-sont-pas-crees","title":"Les logs ne sont pas cr\u00e9\u00e9s","text":"<ol> <li> <p>V\u00e9rifier que Nginx est d\u00e9marr\u00e9 : <pre><code>sudo systemctl status nginx\n</code></pre></p> </li> <li> <p>V\u00e9rifier les permissions : <pre><code>ls -la /var/log/nginx/\n</code></pre></p> </li> <li> <p>V\u00e9rifier la configuration Nginx : <pre><code>sudo nginx -t\n</code></pre></p> </li> </ol>"},{"location":"logs/nginx/#les-logs-sont-vides","title":"Les logs sont vides","text":"<ul> <li>V\u00e9rifier que Nginx re\u00e7oit des requ\u00eates</li> <li>V\u00e9rifier la configuration des logs dans <code>/etc/nginx/sites-available/essensys</code></li> </ul>"},{"location":"logs/traefik/","title":"Logs Traefik","text":"<p>Traefik g\u00e9n\u00e8re des logs d\u00e9taill\u00e9s pour le diagnostic et le monitoring.</p>"},{"location":"logs/traefik/#fichiers-de-logs","title":"Fichiers de logs","text":"<ul> <li>Logs g\u00e9n\u00e9raux : <code>/var/log/traefik/traefik.log</code></li> <li>Logs d'acc\u00e8s : <code>/var/log/traefik/access.log</code></li> </ul>"},{"location":"logs/traefik/#consultation-des-logs","title":"Consultation des logs","text":""},{"location":"logs/traefik/#logs-generaux","title":"Logs g\u00e9n\u00e9raux","text":"<pre><code># Voir en temps r\u00e9el\nsudo tail -f /var/log/traefik/traefik.log\n\n# Derni\u00e8res lignes\nsudo tail -n 100 /var/log/traefik/traefik.log\n</code></pre>"},{"location":"logs/traefik/#logs-dacces","title":"Logs d'acc\u00e8s","text":"<pre><code># Voir en temps r\u00e9el\nsudo tail -f /var/log/traefik/access.log\n\n# Derni\u00e8res lignes\nsudo tail -n 100 /var/log/traefik/access.log\n</code></pre>"},{"location":"logs/traefik/#scripts-de-visualisation","title":"Scripts de visualisation","text":"<p>Des scripts sont fournis pour faciliter la consultation :</p> <pre><code># Voir les logs Traefik\n./traefik-config/view-traefik-logs.sh\n\n# Voir les logs en mode debug profond\n./traefik-config/view-deep-logs.sh\n\n# Capturer le trafic r\u00e9seau\n./traefik-config/capture-network-traffic.sh\n</code></pre>"},{"location":"logs/traefik/#format-des-logs","title":"Format des logs","text":""},{"location":"logs/traefik/#logs-generaux_1","title":"Logs g\u00e9n\u00e9raux","text":"<p>Format : <code>common</code> (lisible) ou <code>json</code> (structur\u00e9)</p> <p>Exemple (format common) : <pre><code>2024-01-02T17:19:35Z [INFO] Starting Traefik\n2024-01-02T17:19:35Z [DEBUG] Configuration loaded\n</code></pre></p>"},{"location":"logs/traefik/#logs-dacces_1","title":"Logs d'acc\u00e8s","text":"<p>Format : <code>json</code> (par d\u00e9faut)</p> <p>Inclut : - Timestamp - M\u00e9thode HTTP - URL - Status code - Dur\u00e9e de la requ\u00eate - Headers (si configur\u00e9) - Informations sur le routeur et le service</p>"},{"location":"logs/traefik/#niveaux-de-log","title":"Niveaux de log","text":"<p>Traefik supporte plusieurs niveaux de log :</p> <ul> <li><code>ERROR</code> : Erreurs critiques</li> <li><code>WARN</code> : Avertissements</li> <li><code>INFO</code> : Informations g\u00e9n\u00e9rales</li> <li><code>DEBUG</code> : Informations de d\u00e9bogage</li> <li><code>TRACE</code> : Toutes les traces (niveau le plus d\u00e9taill\u00e9)</li> </ul> <p>Le niveau est configur\u00e9 dans <code>/etc/traefik/traefik.yml</code> :</p> <pre><code>log:\n  level: TRACE  # Pour voir toutes les connexions\n</code></pre>"},{"location":"logs/traefik/#analyse-des-logs","title":"Analyse des logs","text":""},{"location":"logs/traefik/#compter-les-requetes-par-status-code","title":"Compter les requ\u00eates par status code","text":"<pre><code>sudo jq -r '.statusCode' /var/log/traefik/access.log | sort | uniq -c | sort -rn\n</code></pre>"},{"location":"logs/traefik/#voir-les-requetes-dune-ip-specifique","title":"Voir les requ\u00eates d'une IP sp\u00e9cifique","text":"<pre><code>sudo jq -r 'select(.clientIP == \"192.168.1.151\")' /var/log/traefik/access.log\n</code></pre>"},{"location":"logs/traefik/#voir-les-erreurs","title":"Voir les erreurs","text":"<pre><code>sudo jq -r 'select(.statusCode &gt;= 400)' /var/log/traefik/access.log\n</code></pre>"},{"location":"logs/traefik/#depannage","title":"D\u00e9pannage","text":""},{"location":"logs/traefik/#les-logs-ne-sont-pas-crees","title":"Les logs ne sont pas cr\u00e9\u00e9s","text":"<ol> <li> <p>V\u00e9rifier que Traefik est d\u00e9marr\u00e9 : <pre><code>sudo systemctl status traefik\n</code></pre></p> </li> <li> <p>V\u00e9rifier les permissions : <pre><code>ls -la /var/log/traefik/\n</code></pre></p> </li> <li> <p>V\u00e9rifier la configuration : <pre><code>sudo cat /etc/traefik/traefik.yml | grep -A 5 \"log:\"\n</code></pre></p> </li> </ol>"},{"location":"logs/traefik/#les-logs-sont-vides","title":"Les logs sont vides","text":"<ul> <li>V\u00e9rifier que Traefik re\u00e7oit des requ\u00eates</li> <li>V\u00e9rifier le niveau de log (doit \u00eatre au moins <code>INFO</code>)</li> <li>V\u00e9rifier que les entrypoints sont correctement configur\u00e9s</li> </ul>"},{"location":"maintenance/troubleshooting/","title":"D\u00e9pannage","text":"<p>Guide de d\u00e9pannage pour les probl\u00e8mes courants.</p>"},{"location":"maintenance/troubleshooting/#services-ne-demarrent-pas","title":"Services ne d\u00e9marrent pas","text":""},{"location":"maintenance/troubleshooting/#backend","title":"Backend","text":"<pre><code># V\u00e9rifier les logs\nsudo journalctl -u essensys-backend -n 50\n\n# V\u00e9rifier le binaire\nls -la /opt/essensys/backend/server\n\n# V\u00e9rifier la configuration\ncat /opt/essensys/backend/config.yaml\n</code></pre>"},{"location":"maintenance/troubleshooting/#nginx","title":"Nginx","text":"<pre><code># V\u00e9rifier la configuration\nsudo nginx -t\n\n# V\u00e9rifier les logs\nsudo tail -f /var/log/nginx/error.log\n\n# V\u00e9rifier le port\nsudo netstat -tlnp | grep :80\n</code></pre>"},{"location":"maintenance/troubleshooting/#traefik","title":"Traefik","text":"<pre><code># V\u00e9rifier les logs\nsudo tail -f /var/log/traefik/traefik.log\n\n# V\u00e9rifier la configuration\nsudo cat /etc/traefik/traefik.yml\n\n# V\u00e9rifier les ports\nsudo netstat -tlnp | grep -E ':(80|443)'\n</code></pre>"},{"location":"maintenance/troubleshooting/#problemes-de-connexion","title":"Probl\u00e8mes de connexion","text":""},{"location":"maintenance/troubleshooting/#client-essensys-ne-peut-pas-se-connecter","title":"Client Essensys ne peut pas se connecter","text":"<ol> <li>V\u00e9rifier que Nginx \u00e9coute sur le port 80</li> <li>V\u00e9rifier que le backend fonctionne</li> <li>V\u00e9rifier les logs API d\u00e9taill\u00e9s</li> <li>V\u00e9rifier le firewall</li> </ol>"},{"location":"maintenance/troubleshooting/#frontend-ne-saffiche-pas","title":"Frontend ne s'affiche pas","text":"<ol> <li>V\u00e9rifier que les fichiers existent : <code>ls -la /opt/essensys/frontend/dist/</code></li> <li>V\u00e9rifier les logs Nginx</li> <li>V\u00e9rifier les permissions</li> </ol>"},{"location":"maintenance/troubleshooting/#acces-wan-ne-fonctionne-pas","title":"Acc\u00e8s WAN ne fonctionne pas","text":"<ol> <li>V\u00e9rifier le NAT/port forwarding</li> <li>V\u00e9rifier le domaine WAN dans <code>/home/essensys/domain.txt</code></li> <li>V\u00e9rifier les certificats SSL</li> <li>V\u00e9rifier les logs Traefik</li> </ol>"},{"location":"maintenance/troubleshooting/#problemes-de-ports","title":"Probl\u00e8mes de ports","text":""},{"location":"maintenance/troubleshooting/#port-deja-utilise","title":"Port d\u00e9j\u00e0 utilis\u00e9","text":"<pre><code># Trouver le processus\nsudo lsof -i :7070\nsudo lsof -i :80\nsudo lsof -i :443\n\n# Arr\u00eater le processus\nsudo kill &lt;PID&gt;\n</code></pre>"},{"location":"maintenance/troubleshooting/#conflit-entre-nginx-et-traefik","title":"Conflit entre Nginx et Traefik","text":"<p>Nginx et Traefik peuvent coexister sur le port 80 gr\u00e2ce aux <code>server_name</code> diff\u00e9rents. Si probl\u00e8me, v\u00e9rifier la configuration.</p>"},{"location":"maintenance/uninstall/","title":"D\u00e9sinstallation","text":"<p>Guide pour d\u00e9sinstaller compl\u00e8tement Essensys du Raspberry Pi.</p>"},{"location":"maintenance/uninstall/#desinstallation-automatique","title":"D\u00e9sinstallation automatique","text":""},{"location":"maintenance/uninstall/#script-uninstallsh","title":"Script uninstall.sh","text":"<p>Le script <code>uninstall.sh</code> automatise la d\u00e9sinstallation compl\u00e8te :</p> <pre><code>cd ~/essensys-raspberry-install\nsudo ./uninstall.sh\n</code></pre> <p>Le script va : 1. Demander confirmation 2. Arr\u00eater et d\u00e9sactiver tous les services 3. Supprimer les fichiers de service systemd 4. Supprimer la configuration Nginx 5. Supprimer la configuration Traefik 6. Supprimer les binaires 7. Supprimer les fichiers d'installation 8. Supprimer tous les logs 9. Optionnellement supprimer l'utilisateur et les d\u00e9p\u00f4ts</p>"},{"location":"maintenance/uninstall/#desinstallation-manuelle","title":"D\u00e9sinstallation manuelle","text":""},{"location":"maintenance/uninstall/#arreter-les-services","title":"Arr\u00eater les services","text":"<pre><code>sudo systemctl stop essensys-backend\nsudo systemctl stop traefik\nsudo systemctl stop traefik-block-service\nsudo systemctl stop nginx\n</code></pre>"},{"location":"maintenance/uninstall/#supprimer-les-services","title":"Supprimer les services","text":"<pre><code>sudo systemctl disable essensys-backend\nsudo systemctl disable traefik\nsudo systemctl disable traefik-block-service\nsudo rm /etc/systemd/system/essensys-backend.service\nsudo rm /etc/systemd/system/traefik.service\nsudo rm /etc/systemd/system/traefik-block-service.service\nsudo systemctl daemon-reload\n</code></pre>"},{"location":"maintenance/uninstall/#supprimer-les-fichiers","title":"Supprimer les fichiers","text":"<pre><code># Configuration\nsudo rm -rf /etc/traefik\nsudo rm /etc/nginx/sites-available/essensys\nsudo rm /etc/nginx/sites-enabled/essensys\n\n# Installation\nsudo rm -rf /opt/essensys\n\n# Logs\nsudo rm -rf /var/logs/Essensys\nsudo rm -rf /var/log/traefik\nsudo rm -f /var/log/nginx/essensys-*.log\n\n# Binaires\nsudo rm -f /usr/local/bin/traefik\nsudo rm -f /usr/local/bin/traefik-block-service.py\n</code></pre>"},{"location":"maintenance/uninstall/#supprimer-lutilisateur-optionnel","title":"Supprimer l'utilisateur (optionnel)","text":"<pre><code>sudo userdel -r essensys\n</code></pre>"},{"location":"maintenance/update/","title":"Mise \u00e0 jour","text":"<p>Guide pour mettre \u00e0 jour Essensys sur le Raspberry Pi.</p>"},{"location":"maintenance/update/#mise-a-jour-automatique","title":"Mise \u00e0 jour automatique","text":""},{"location":"maintenance/update/#script-updatesh","title":"Script update.sh","text":"<p>Le script <code>update.sh</code> automatise la mise \u00e0 jour compl\u00e8te :</p> <pre><code>cd ~/essensys-raspberry-install\nsudo ./update.sh\n</code></pre> <p>Le script va : 1. Mettre \u00e0 jour les d\u00e9p\u00f4ts backend et frontend depuis GitHub 2. Recompiler le backend Go 3. Rebuild le frontend React 4. Mettre \u00e0 jour la configuration Nginx 5. Mettre \u00e0 jour la configuration Traefik (lit <code>/home/essensys/domain.txt</code>) 6. Red\u00e9marrer tous les services 7. V\u00e9rifier que tous les services sont actifs</p>"},{"location":"maintenance/update/#mise-a-jour-manuelle","title":"Mise \u00e0 jour manuelle","text":""},{"location":"maintenance/update/#backend","title":"Backend","text":"<pre><code>cd /home/essensys/essensys-server-backend\ngit pull\ngo mod tidy\ngo build -o server ./cmd/server\nsudo cp server /opt/essensys/backend/\nsudo systemctl restart essensys-backend\n</code></pre>"},{"location":"maintenance/update/#frontend","title":"Frontend","text":"<pre><code>cd /home/essensys/essensys-server-frontend\ngit pull\nnpm install\nnpm run build\nsudo cp -r dist/* /opt/essensys/frontend/dist/\nsudo systemctl reload nginx\n</code></pre>"},{"location":"maintenance/update/#verification-apres-mise-a-jour","title":"V\u00e9rification apr\u00e8s mise \u00e0 jour","text":"<pre><code># V\u00e9rifier les services\nsudo systemctl status essensys-backend\nsudo systemctl status nginx\nsudo systemctl status traefik\n\n# Tester l'acc\u00e8s\ncurl http://mon.essensys.fr/health\n</code></pre>"},{"location":"router/","title":"Configuration Routeur","text":"<p>Cette section explique comment configurer le NAT/port forwarding sur diff\u00e9rents routeurs pour permettre l'acc\u00e8s WAN.</p>"},{"location":"router/#sections","title":"Sections","text":"<ol> <li>Ubiquiti Dream Machine Pro - Configuration sur UDM Pro</li> <li>Freebox - Configuration sur Freebox</li> <li>SFR - Configuration sur routeur SFR</li> <li>Orange Livebox - Configuration sur Orange Livebox</li> </ol>"},{"location":"router/#vue-densemble","title":"Vue d'ensemble","text":"<p>Pour permettre l'acc\u00e8s WAN, vous devez configurer :</p> <ol> <li>NAT/Port forwarding :</li> <li>Port 80 \u2192 192.168.1.101:80</li> <li> <p>Port 443 \u2192 192.168.1.101:443</p> </li> <li> <p>DNS local (optionnel) :</p> </li> <li> <p><code>mon.essensys.fr</code> \u2192 192.168.1.101</p> </li> <li> <p>DNS public (pour WAN) :</p> </li> <li><code>essensys.acme.com</code> \u2192 Votre IP publique</li> </ol>"},{"location":"router/#ports-a-rediriger","title":"Ports \u00e0 rediriger","text":"Port externe Port interne Service 80 80 Nginx (API locales) 443 443 Traefik (Frontend WAN HTTPS)"},{"location":"router/#test-de-la-configuration","title":"Test de la configuration","text":""},{"location":"router/#test-local","title":"Test local","text":"<pre><code># Depuis le r\u00e9seau local\ncurl http://mon.essensys.fr/health\n</code></pre>"},{"location":"router/#test-wan","title":"Test WAN","text":"<pre><code># Depuis Internet\ncurl https://essensys.acme.com/\n</code></pre>"},{"location":"router/freebox/","title":"Configuration Freebox","text":"<p>Configuration du NAT/port forwarding sur Freebox.</p>"},{"location":"router/freebox/#natport-forwarding","title":"NAT/Port Forwarding","text":""},{"location":"router/freebox/#via-linterface-freebox","title":"Via l'interface Freebox","text":"<ol> <li>Se connecter \u00e0 l'interface Freebox (http://mafreebox.freebox.fr)</li> <li>Aller dans Param\u00e8tres de la Freebox \u2192 Gestion des ports</li> <li>Cliquer sur Ajouter une redirection de port</li> <li>Configurer :</li> </ol> <p>Redirection 1 : Port 80 - Nom : Essensys HTTP - Protocole : TCP - Port externe : 80 - Port interne : 80 - IP interne : 192.168.1.101</p> <p>Redirection 2 : Port 443 - Nom : Essensys HTTPS - Protocole : TCP - Port externe : 443 - Port interne : 443 - IP interne : 192.168.1.101</p>"},{"location":"router/freebox/#configuration-dns-local","title":"Configuration DNS local","text":"<p>La Freebox g\u00e8re automatiquement le DNS local. Pour ajouter une entr\u00e9e personnalis\u00e9e, utiliser l'interface Freebox ou configurer directement sur les machines clientes via <code>/etc/hosts</code>.</p>"},{"location":"router/freebox/#verification","title":"V\u00e9rification","text":"<p>V\u00e9rifier que les redirections sont actives dans l'interface Freebox.</p>"},{"location":"router/orange-livebox/","title":"Configuration Orange Livebox","text":"<p>Configuration du NAT/port forwarding sur Orange Livebox.</p>"},{"location":"router/orange-livebox/#natport-forwarding","title":"NAT/Port Forwarding","text":""},{"location":"router/orange-livebox/#via-linterface-livebox","title":"Via l'interface Livebox","text":"<ol> <li>Se connecter \u00e0 l'interface Livebox (http://192.168.1.1)</li> <li>Aller dans Param\u00e8tres avanc\u00e9s \u2192 NAT/PAT ou Redirection de ports</li> <li>Ajouter les r\u00e8gles :</li> </ol> <p>R\u00e8gle 1 : Port 80 - Nom : Essensys HTTP - Protocole : TCP - Port externe : 80 - Port interne : 80 - IP interne : 192.168.1.101</p> <p>R\u00e8gle 2 : Port 443 - Nom : Essensys HTTPS - Protocole : TCP - Port externe : 443 - Port interne : 443 - IP interne : 192.168.1.101</p>"},{"location":"router/orange-livebox/#configuration-dns-local","title":"Configuration DNS local","text":"<p>Configurer le DNS local via l'interface Livebox ou utiliser <code>/etc/hosts</code> sur les machines clientes.</p>"},{"location":"router/orange-livebox/#verification","title":"V\u00e9rification","text":"<p>V\u00e9rifier que les r\u00e8gles sont actives dans l'interface Livebox.</p>"},{"location":"router/sfr/","title":"Configuration SFR","text":"<p>Configuration du NAT/port forwarding sur routeur SFR.</p>"},{"location":"router/sfr/#natport-forwarding","title":"NAT/Port Forwarding","text":""},{"location":"router/sfr/#via-linterface-sfr","title":"Via l'interface SFR","text":"<ol> <li>Se connecter \u00e0 l'interface du routeur SFR (g\u00e9n\u00e9ralement http://192.168.1.1)</li> <li>Aller dans Param\u00e8tres avanc\u00e9s \u2192 NAT/PAT ou Redirection de ports</li> <li>Ajouter les r\u00e8gles :</li> </ol> <p>R\u00e8gle 1 : Port 80 - Nom : Essensys HTTP - Protocole : TCP - Port externe : 80 - Port interne : 80 - IP interne : 192.168.1.101</p> <p>R\u00e8gle 2 : Port 443 - Nom : Essensys HTTPS - Protocole : TCP - Port externe : 443 - Port interne : 443 - IP interne : 192.168.1.101</p>"},{"location":"router/sfr/#configuration-dns-local","title":"Configuration DNS local","text":"<p>Configurer le DNS local via l'interface du routeur ou utiliser <code>/etc/hosts</code> sur les machines clientes.</p>"},{"location":"router/sfr/#verification","title":"V\u00e9rification","text":"<p>V\u00e9rifier que les r\u00e8gles sont actives dans l'interface du routeur.</p>"},{"location":"router/ubiquiti-udm-pro/","title":"Configuration Ubiquiti Dream Machine Pro","text":"<p>Configuration du NAT/port forwarding et DNS sur Ubiquiti Dream Machine Pro.</p>"},{"location":"router/ubiquiti-udm-pro/#natport-forwarding","title":"NAT/Port Forwarding","text":""},{"location":"router/ubiquiti-udm-pro/#via-linterface-unifi","title":"Via l'interface Unifi","text":"<ol> <li>Se connecter \u00e0 l'interface Unifi Controller</li> <li>Aller dans Settings \u2192 Networks \u2192 WAN</li> <li>Cliquer sur Port Forwarding</li> <li>Ajouter les r\u00e8gles suivantes :</li> </ol> <p>R\u00e8gle 1 : Port 80 - Name : Essensys HTTP - Port : 80 - Forward IP : 192.168.1.101 - Forward Port : 80 - Protocol : TCP</p> <p>R\u00e8gle 2 : Port 443 - Name : Essensys HTTPS - Port : 443 - Forward IP : 192.168.1.101 - Forward Port : 443 - Protocol : TCP</p>"},{"location":"router/ubiquiti-udm-pro/#via-ssh-methode-avancee","title":"Via SSH (m\u00e9thode avanc\u00e9e)","text":"<p>Se connecter en SSH au UDM Pro :</p> <pre><code>ssh root@&lt;ip-udm-pro&gt;\n</code></pre> <p>\u00c9diter la configuration :</p> <pre><code>vi /mnt/data/udapi-config/port-forwarding.json\n</code></pre>"},{"location":"router/ubiquiti-udm-pro/#configuration-dns-local","title":"Configuration DNS local","text":""},{"location":"router/ubiquiti-udm-pro/#via-linterface-unifi_1","title":"Via l'interface Unifi","text":"<ol> <li>Aller dans Settings \u2192 Networks \u2192 LAN</li> <li>Cliquer sur DHCP \u2192 DNS</li> <li>Ajouter une entr\u00e9e DNS :</li> <li>Hostname : <code>mon.essensys.fr</code></li> <li>IP : <code>192.168.1.101</code></li> </ol>"},{"location":"router/ubiquiti-udm-pro/#via-ssh-persistant","title":"Via SSH (persistant)","text":"<p>Se connecter en SSH au UDM Pro :</p> <pre><code>ssh root@&lt;ip-udm-pro&gt;\n</code></pre> <p>Cr\u00e9er/modifier le fichier de configuration DNS :</p> <pre><code>vi /mnt/data/udapi-config/dnsmasq.conf\n</code></pre> <p>Ajouter : <pre><code>host-record=mon.essensys.fr,192.168.1.101\nhost-record=traefik.essensys.fr,192.168.1.101\n</code></pre></p> <p>Red\u00e9marrer dnsmasq :</p> <pre><code>/etc/init.d/dnsmasq restart\n</code></pre>"},{"location":"router/ubiquiti-udm-pro/#configuration-persistante-via-configgatewayjson","title":"Configuration persistante via config.gateway.json","text":"<p>Pour une configuration persistante qui survit aux mises \u00e0 jour :</p> <ol> <li>Se connecter en SSH au UDM Pro</li> <li>Cr\u00e9er/modifier <code>/mnt/data/udapi-config/config.gateway.json</code> :</li> </ol> <pre><code>{\n  \"service\": {\n    \"dns\": {\n      \"forwarding\": {\n        \"options\": [\n          \"host-record=mon.essensys.fr,192.168.1.101\",\n          \"host-record=traefik.essensys.fr,192.168.1.101\"\n        ]\n      }\n    }\n  }\n}\n</code></pre> <ol> <li>Appliquer la configuration : <pre><code>/usr/bin/udapi-config-apply\n</code></pre></li> </ol>"},{"location":"router/ubiquiti-udm-pro/#verification","title":"V\u00e9rification","text":""},{"location":"router/ubiquiti-udm-pro/#verifier-le-port-forwarding","title":"V\u00e9rifier le port forwarding","text":"<pre><code># Depuis l'interface Unifi\n# Aller dans Settings \u2192 Networks \u2192 WAN \u2192 Port Forwarding\n# V\u00e9rifier que les r\u00e8gles sont actives\n</code></pre>"},{"location":"router/ubiquiti-udm-pro/#verifier-le-dns","title":"V\u00e9rifier le DNS","text":"<pre><code># Depuis une machine du r\u00e9seau local\nnslookup mon.essensys.fr\n# Devrait retourner 192.168.1.101\n</code></pre>"},{"location":"router/ubiquiti-udm-pro/#depannage","title":"D\u00e9pannage","text":""},{"location":"router/ubiquiti-udm-pro/#les-ports-ne-sont-pas-rediriges","title":"Les ports ne sont pas redirig\u00e9s","text":"<ol> <li>V\u00e9rifier que les r\u00e8gles sont actives dans l'interface Unifi</li> <li>V\u00e9rifier que le firewall n'est pas bloquant</li> <li>V\u00e9rifier les logs du routeur</li> </ol>"},{"location":"router/ubiquiti-udm-pro/#le-dns-ne-fonctionne-pas","title":"Le DNS ne fonctionne pas","text":"<ol> <li>V\u00e9rifier que la configuration DNS est correcte</li> <li> <p>Red\u00e9marrer dnsmasq : <pre><code>/etc/init.d/dnsmasq restart\n</code></pre></p> </li> <li> <p>V\u00e9rifier la r\u00e9solution : <pre><code>nslookup mon.essensys.fr\n</code></pre></p> </li> </ol>"}]}