# Configuration des routes LOCALES (mon.essensys.fr)
# Traefik gère uniquement le frontend local
# Les API sont gérées par Nginx directement (port 80) pour compatibilité client legacy

http:
  routers:
    # Dashboard Traefik (console admin)
    # Le dashboard inclut automatiquement les métriques et les logs d'accès
    traefik-dashboard:
      rule: "Host(`traefik.essensys.fr`)"
      entryPoints:
        - web
      service: api@internal
      priority: 100
    
    # Frontend local (proxy vers Nginx qui sert le frontend sur port 9090)
    frontend-local:
      rule: "Host(`mon.essensys.fr`)"
      entryPoints:
        - web
      service: frontend-service
      priority: 10

  services:
    # Service frontend (proxy vers nginx qui sert les fichiers statiques)
    # Nginx écoute sur port 9090 en interne pour servir le frontend
    frontend-service:
      loadBalancer:
        servers:
          - url: "http://127.0.0.1:9090"
        passHostHeader: true

