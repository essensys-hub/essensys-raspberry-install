# Configuration des routes LOCALES
# NOTE: Les routes locales sont gérées par Nginx directement (port 80)
# Traefik gère le dashboard sur port 8080 (accessible depuis subnet local)
# Traefik gère le frontend WAN (port 443)

http:
  routers:
    # Dashboard Traefik (console admin) - accessible depuis le subnet local
    # Accessible via:
    # - http://traefik.essensys.fr/dashboard/ (Nginx proxy vers port 8080)
    # - http://<ip-raspberry>:8080/dashboard/ (accès direct)
    traefik-dashboard:
      rule: "Host(`traefik.essensys.fr`) || HostRegexp(`.*`)"
      entryPoints:
        - dashboard
      service: api@internal
      priority: 100

  services:
    # Service frontend (proxy vers nginx qui sert les fichiers statiques)
    # Nginx écoute sur port 9090 en interne pour servir le frontend
    frontend-service:
      loadBalancer:
        servers:
          - url: "http://127.0.0.1:9090"
        passHostHeader: true

